<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="42692,5956745139" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{ IF ((&#60;GLOBAL_EDUCACAO&#62; &#60;&#62; 'R')) THEN    &#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;      &#13;&#10;&#13;&#10;  end;}  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);  &#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;SqlListagem.Open;&#13;&#10;SqlESTUDO.Open;&#13;&#10;SqlPeriodo.Open;&#13;&#10;SqlBloco.Open;                          &#13;&#10;  while not SqlListagem.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlListagem.FieldByName('TURMA').AsString);&#13;&#10;    SqlListagem.Next;    &#13;&#10;  &#13;&#10;  END;&#13;&#10;&#13;&#10;   while not SqlESTUDO.EOF do&#13;&#10;  begin&#13;&#10;   ComboBox4.Items.Add(SqlEstudo.FieldByName('SERIE_ESTUDO').AsString);&#13;&#10;    SqlEstudo.Next;  &#13;&#10;  &#13;&#10;  END;&#13;&#10;  while not SqlPeriodo.EOF do&#13;&#10;  begin&#13;&#10;       ComboBox5.Items.Add(SqlPeriodo.FieldByName('PERIODO').AsString);&#13;&#10;       SqlPeriodo.Next;                                       &#13;&#10;  end;                &#13;&#10;&#13;&#10;  while not SqlBloco.EOF do&#13;&#10;  begin&#13;&#10;       ComboBox2.Items.Add(SqlBloco.FieldByName('galeria').asString);&#13;&#10;       SqlBloco.Next;                                           &#13;&#10;  end;&#13;&#10;&#13;&#10;             &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;    &#13;&#10;procedure ComboBox2OnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; ComboBox3.Items.Clear;                              &#13;&#10; SqlAla.Close;                             &#13;&#10; SqlAla.Open;    &#13;&#10; while not SqlAla.EOF do&#13;&#10;  begin&#13;&#10;       Combobox3.Items.Add(SqlAla.FieldByName('solario').asString);&#13;&#10;       SqlAla.Next;                                     &#13;&#10;  end;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;end.&#13;&#10;&#13;&#10;  " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D2200010C2E00000020446174615365743D2253716C4368616D6164612220446174615365744E616D653D2253716C4368616D6164612200010C2C00000020446174615365743D2253716C45737475646F2220446174615365744E616D653D2253716C45737475646F2200010C2E00000020446174615365743D2253716C506572696F646F2220446174615365744E616D653D2253716C506572696F646F2200010C2A00000020446174615365743D2253716C426C6F636F2220446174615365744E616D653D2253716C426C6F636F2200010C2600000020446174615365743D2253716C416C612220446174615365744E616D653D2253716C416C61220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667402300470546F700220"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402700470546F7002200A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     TURMA                                                                           &#13;&#10;FROM INTERNO                                                                     &#13;&#10;WHERE   coalesce(TURMA, '') &#60;&#62; ''                                                      &#13;&#10;  &#13;&#10;ORDER BY TURMA&#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;    " Database="database" PropData="05704C65667402300470546F7002540A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlChamada" UserName="SqlChamada" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.nome_interno,i.periodo, i.turma, i.foto, i.rgi, i.data_matricula, p.pavilhao, g.galeria,&#13;&#10;c.cela, s.solario, u.id_up, u.nome_up, t.serie_estudo        &#13;&#10;from interno i&#13;&#10;   INNER JOIN PAVILHAO p ON (I.idpavilhao = P.id_pavilhao)&#13;&#10;   INNER JOIN GALERIA g ON (I.idgaleria = G.id_galeria)&#13;&#10;   INNER JOIN CELA c ON (I.idcela = C.id_cela)&#13;&#10;   INNER JOIN SOLARIO s ON (I.idsolario = S.id_solario)&#13;&#10;   INNER JOIN unidade_penal u ON (I.id_up = u.id_up)&#13;&#10;   INNER JOIN serie_estudo t ON (I.idserieestudo = t.id_serie_estudo)       &#13;&#10;&#13;&#10;WHERE I.ST = 'A' AND I.ID_UP = :ID_UP&#13;&#10;AND I.TURMA LIKE '%' || :TURMA || '%' AND SERIE_ESTUDO LIKE '%' || :SERIE || '%'&#13;&#10;AND ( I.PERIODO LIKE '%' || :PERIODO ||'%' or I.PERIODO='Diurno' )    &#13;&#10;AND g.GALERIA LIKE '%'||(:GALERIA)||''&#13;&#10;AND s.solario LIKE '%'||(:SOLARIO)||'%'                                                                                     &#13;&#10;ORDER BY s.solario, I.nome_interno                                                 &#13;&#10;                                           " Database="database" PropData="05704C65667402700470546F7002540A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3D000000204E616D653D225455524D41222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78312E746578742200010C3D000000204E616D653D225345524945222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58342E544558542200010C3F000000204E616D653D22504552494F444F222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58352E544558542200010C3F000000204E616D653D2247414C45524941222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58322E544558542200010C3F000000204E616D653D22534F4C4152494F222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58332E54455854220000"/>
    <TfrxDBXQuery Name="SqlEstudo" UserName="SqlEstudo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     ID_SERIE_ESTUDO, SERIE_ESTUDO                                                                                                               &#13;&#10;FROM SERIE_ESTUDO     &#13;&#10;    &#13;&#10;WHERE   coalesce(SERIE_ESTUDO, '') &#60;&#62; ''&#13;&#10;&#13;&#10;    &#13;&#10;ORDER BY  SERIE_ESTUDO&#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;              " Database="database" PropData="05704C65667402500470546F7003A4000A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlPeriodo" UserName="SqlPeriodo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     PERIODO                                                                                       &#13;&#10;FROM INTERNO                                                                     &#13;&#10;WHERE   coalesce(PERIODO, '') &#60;&#62; ''                                                                                &#13;&#10;  &#13;&#10;ORDER BY PERIODO            &#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;    " Database="database" PropData="05704C65667403C8000470546F7002200A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlBloco" UserName="SqlBloco" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria    " Database="database" PropData="05704C65667403C8000470546F7002600A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlAla" UserName="SqlAla" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select s.solario from solario s&#13;&#10;inner join galeria g on (g.id_galeria = s.idgaleria)    &#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)                                                                                                                   &#13;&#10;where p.id_up = :id_up and g.galeria = :GALERIA                                                            &#13;&#10;order by s.solario                         " Database="database" PropData="05704C65667403AC000470546F7003B4000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D2247414C45524941222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78322E74657874220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="4" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="5" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="18,89765" Left="0" ParentFont="False" Top="56" Width="737,00835" ColumnWidth="0" ColumnGap="0" DataSet="SqlChamada" DataSetName="SqlChamada" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Left="-1" Top="0" Width="28,1023622" Height="18,8976378" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[line]"/>
      <TfrxMemoView Name="SqlChamadaRGI" Left="28,45671" Top="0" Width="63,25201" Height="18,89765" DataField="RGI" DataSet="SqlChamada" DataSetName="SqlChamada" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[SqlChamada.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="SqlChamadaNOME_INTERNO" Left="175,19697" Top="0" Width="242,55905512" Height="18,89765" DataField="NOME_INTERNO" DataSet="SqlChamada" DataSetName="SqlChamada" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[SqlChamada.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="417,63779528" Top="0" Width="317,48031496" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" Frame.Typ="15" ParentFont="False" Text="[SqlChamada.&#34;GALERIA&#34;] - [SqlChamada.&#34;SOLARIO&#34;] "/>
      <TfrxMemoView Name="Memo3" Left="92" Top="0" Width="83,25201" Height="18,89765" DataSet="SqlChamada" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[SqlChamada.&#34;Data_matricula&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="19,29921667" Left="0" Top="16" Width="737,00835">
      <TfrxMemoView Name="Memo45" Left="0" Top="0" Width="27,96850394" Height="19,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NÂº"/>
      <TfrxMemoView Name="Memo46" Left="28,34645669" Top="0" Width="64,20472441" Height="19,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Pront."/>
      <TfrxMemoView Name="Memo47" Left="92,60637" Top="0" Width="83,1496063" Height="19,19686667" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Data Matr."/>
      <TfrxMemoView Name="Memo2" Left="417,5436" Top="0" Width="317,5906" Height="19,19686667" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Galeria"/>
      <TfrxMemoView Name="Memo48" Left="176,07874016" Top="0,10235" Width="241,5906" Height="19,19686667" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Nome"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="200" Left="330" Top="131" Width="459" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="234" Top="107" Width="75" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="OK" ModalResult="1"/>
    <TfrxButtonControl Name="Button2" Left="350" Top="107" Width="75" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Sair" ModalResult="2"/>
    <TfrxLabelControl Name="CALIBRE" Left="11" Top="1" Width="38" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Série" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="231" Top="22" Width="201" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
    <TfrxLabelControl Name="Label3" Left="45" Top="152" Width="325" Height="13" Font.Charset="1" Font.Color="255" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="* Deixar em branco o campo acima para relacionar todas as turmas." Color="13948117" OnClick="Label3OnClick"/>
    <TfrxLabelControl Name="Label4" Left="231" Top="0" Width="49" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Turma" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox4" Left="11" Top="23" Width="201" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
    <TfrxComboBoxControl Name="ComboBox5" Left="12" Top="68" Width="201" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
    <TfrxLabelControl Name="Label5" Left="12" Top="44" Width="57" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Periodo" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxLabelControl Name="Label1" Left="232" Top="44" Width="41" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Bloco" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox2" Left="232" Top="68" Width="201" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnChange="ComboBox2OnChange" OnClick="ComboBox1OnClick"/>
    <TfrxLabelControl Name="Label2" Left="12" Top="92" Width="23" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Ala" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox3" Left="12" Top="116" Width="201" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
