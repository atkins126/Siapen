<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="42718,587699294" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;  &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                            &#13;&#10;// memo11.text :='RELAÇÃO DE MUDANÇAS DE CELA - PERÍODO   '+ datetostr(dateedit2.date)+''+'   a   '+''+datetostr(dateedit1.date);&#13;&#10;// memo3.text := 'Brasília-DF, '+ datetostr(dateedit1.date);&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');                       &#13;&#10;  SqlListaCargo.Open;&#13;&#10;  SqlTurma.Open;                                    &#13;&#10;   while not SqlListaCargo.EOF do&#13;&#10;   begin&#13;&#10;    ComboBox3.Items.Add(SqlListaCargo.FieldByName('funcao').AsString);&#13;&#10;    ComboBox4.Items.Add(SqlListaCargo.FieldByName('funcao').AsString);&#13;&#10;    SqlListacargo.Next;&#13;&#10;   end;&#13;&#10;   while not SqlTurma.EOF do&#13;&#10;   begin&#13;&#10;    Combobox1.Items.Add(SqlTurma.FieldByName('Turma').AsString);&#13;&#10;    SqlTurma.Next;                                    &#13;&#10;   end;&#13;&#10;    SqlTurma.Close;                                              &#13;&#10;    SqlListaCargo.Close;                                                     &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                               &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DateEdit2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;               &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo13OnAfterData(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                        &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure Label7OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Edit1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure ComboBox4OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;                          &#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3A00000020446174615365743D2273716C5472616E73666572656E6369612220446174615365744E616D653D2273716C5472616E73666572656E6369612200010C3800000020446174615365743D2273716C556E696461646550656E616C2220446174615365744E616D653D2273716C556E696461646550656E616C2200010C2E00000020446174615365743D2253514C44495245544F522220446174615365744E616D653D2253514C44495245544F522200010C3800000020446174615365743D2273716C4C69737461696E7465726E6F2220446174615365744E616D653D2273716C4C69737461696E7465726E6F2200010C3400000020446174615365743D2253716C4C69737461436172676F2220446174615365744E616D653D2253716C4C69737461436172676F2200010C2C00000020446174615365743D2253716C436172676F312220446174615365744E616D653D2253716C436172676F312200010C2C00000020446174615365743D2253716C436172676F322220446174615365744E616D653D2253716C436172676F322200010C2A00000020446174615365743D2253716C5475726D612220446174615365744E616D653D2253716C5475726D61220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C17000000204E616D653D22474C4F42414C5F4A555249444943412200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C13000000204E616D653D22444154415F494E4943494F2200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C656674039C000470546F70021C"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403DC000470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlTransferencia" UserName="sqlTransferencia" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT&#13;&#10; i.rgi, i.nome_interno, i.pai, i.mae, i.vulgo,i.turma,coalesce(i.tipoconduta, 'Bom') as conduta,                                                                                                                               &#13;&#10; ht.Documento, ha.data_inicial, ha.data_final, ha.qtde_horas, t.serie_estudo, coalesce(p.nprocesso,'Colocar Processo') as nprocesso, p.vara as vara                                                                                                                                                                                                                                                                                                         &#13;&#10;from interno i&#13;&#10;inner join horas_aula ha on (i.id_interno = ha.id_interno)  &#13;&#10;INNER JOIN historico_trabalho ht ON (i.id_interno = ht.id_interno)&#13;&#10;INNER JOIN funcao_interno f ON (ht.id_funcao_interno = f.id_funcao_interno)&#13;&#10;INNER JOIN serie_estudo t ON (i.idserieestudo = t.id_serie_estudo)&#13;&#10;LEFT JOIN processo p ON (p.idinterno = i.id_interno)                        &#13;&#10;WHERE f.funcao_interno = 'ALUNO' and ha.data_inicial &#62;= :data1 and ha.data_final &#60;=:data2&#13;&#10;AND I.TURMA LIKE '%' || :TURMA || '%' AND ht.DATA_SAIDA is null                               &#13;&#10;order by t.serie_estudo, i.nome_interno                                                                                        &#13;&#10;&#13;&#10;                                                   " Database="Database" PropData="05704C65667402480470546F700314010A506172616D657465727301010C3B000000204E616D653D226461746131222044617461547970653D22667444617465222045787072657373696F6E3D226461746565646974312E646174652200010C3B000000204E616D653D226461746132222044617461547970653D22667444617465222045787072657373696F6E3D226461746565646974322E646174652200010C3D000000204E616D653D225455524D41222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78312E74657874220000"/>
    <TfrxDBXQuery Name="sqlUnidadePenal" UserName="sqlUnidadePenal" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select nome_up from unidade_penal&#13;&#10;where id_up = :id_up  " Database="Database" PropData="05704C65667402440470546F70021C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SQLDIRETOR" UserName="SQLDIRETOR" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.nome_funcionario, u.nome_up, f.funcao, u.sigla from funcionario f&#13;&#10;inner join unidade_penal u on (u.id_up=f.id_up)&#13;&#10;where f.id_up = :id_up and f.funcao = 'DIRETOR'  " Database="Database" PropData="05704C6566740398000470546F7003E0000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlListainterno" UserName="sqlListainterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;i.nome_interno,&#13;&#10;i.RGI,                            &#13;&#10;i.id_interno                          &#13;&#10;from interno i    &#13;&#10;where I.ID_UP = :ID_UP&#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;order by i.nome_interno  " Database="Database" PropData="05704C6566740308010470546F7002700A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListaCargo" UserName="SqlListaCargo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.funcao from funcionario f&#13;&#10;inner join unidade_penal u on (u.id_up=f.id_up)&#13;&#10;where f.id_up = :id_up  " Database="Database" PropData="05704C6566740310010470546F7003C8000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlCargo1" UserName="SqlCargo1" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.nome_funcionario, u.nome_up, f.funcao, u.sigla from funcionario f&#13;&#10;inner join unidade_penal u on (u.id_up=f.id_up)&#13;&#10;where f.id_up = :id_up and f.funcao = :FUNCAO              " Database="Database" PropData="05704C656674038C010470546F7003C8000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3E000000204E616D653D2246554E43414F222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F426F78332E74657874220000"/>
    <TfrxDBXQuery Name="SqlCargo2" UserName="SqlCargo2" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.nome_funcionario, u.nome_up, f.funcao, u.sigla from funcionario f&#13;&#10;inner join unidade_penal u on (u.id_up=f.id_up)&#13;&#10;where f.id_up = :id_up and f.funcao = :FUNCAO                              " Database="Database" PropData="05704C65667403F8010470546F7003C8000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3E000000204E616D653D2246554E43414F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78342E74657874220000"/>
    <TfrxDBXQuery Name="SqlTurma" UserName="SqlTurma" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     TURMA                                                                           &#13;&#10;FROM INTERNO                                                                     &#13;&#10;WHERE   coalesce(TURMA, '') &#60;&#62; ''                                                      &#13;&#10;  &#13;&#10;ORDER BY TURMA&#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;    " Database="Database" PropData="05704C6566740310010470546F700318010A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="26,45671" Left="0" Top="71,81107" Width="680,3154" OnAfterPrint="MasterData1OnAfterPrint" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="sqlTransferencia" DataSetName="sqlTransferencia" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo10" Left="11,33859" Top="0" Width="650,07916" Height="18,89765" StretchMode="smMaxHeight" AllowHTMLTags="True" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.ShadowWidth="1" Frame.Typ="15" HAlign="haBlock" ParentFont="False" Text="[SqlTransferencia.&#34;Nome_Interno&#34;] | MÃ£e: [SqlTransferencia.&#34;mae&#34;] | &#60;b&#62;[SQLTransferencia.&#34;nprocesso&#34;]&#60;/b&#62; - [SQLTransferencia.&#34;vara&#34;] | [SqlTransferencia.&#34;Documento&#34;] | [SQLTransferencia.&#34;Data_Inicial&#34;] | [SQLTransferencia.&#34;Data_Final&#34;] - &#60;b&#62;[SqlTransferencia.&#34;Conduta&#34;]&#60;/b&#62; - Horas aulas : [SQLTransferencia.&#34;QTDE_HORAS&#34;]h | Dias remidos:  [Round(&#60;SQLTransferencia.&#34;QTDE_HORAS&#34;&#62;/12)] dias."/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="30,23624" Left="0" Top="18,89765" Width="680,3154" Condition="sqlTransferencia.&#34;serie_estudo&#34;">
      <TfrxMemoView Name="Memo1" Left="11,33859" Top="11,33859" Width="650,07916" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.ShadowWidth="1" Frame.Typ="15" HAlign="haBlock" ParentFont="False" Text="[SqlTransferencia.&#34;Serie_estudo&#34;]"/>
    </TfrxGroupHeader>
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="204,09462" Width="680,3154">
      <TfrxMemoView Name="Memo2" Left="264,5671" Top="3,77953" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="PÃ¡gina: [Page]"/>
    </TfrxPageFooter>
    <TfrxReportSummary Name="ReportSummary1" Height="22,67718" Left="0" Top="158,74026" Width="680,3154">
      <TfrxMemoView Name="Memo3" Left="3,77953" Top="3,77953" Width="317,48052" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Total de Recuperandos: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="470" Left="467" Top="110" Width="408" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="btnOk" Left="128" Top="292" Width="143" Height="53" Caption="OK" Default="True" ModalResult="1" OnClick="btnOkOnClick"/>
    <TfrxLabelControl Name="Label5" Left="12" Top="148" Width="146" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Cargo Assinatura 1" Color="13948117"/>
    <TfrxComboBoxControl Name="ComboBox3" Left="12" Top="168" Width="377" Height="21" Color="-16777211" Items.Text="" Text="DIRETOR" ItemIndex="-1"/>
    <TfrxLabelControl Name="Label6" Left="12" Top="192" Width="146" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Cargo Assinatura 2" Color="13948117"/>
    <TfrxComboBoxControl Name="ComboBox4" Left="12" Top="212" Width="377" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox4OnClick"/>
    <TfrxLabelControl Name="Label7" Left="12" Top="232" Width="100" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Responsavel" Color="13948117" OnClick="Label7OnClick"/>
    <TfrxEditControl Name="Edit1" Left="12" Top="248" Width="377" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" OnClick="Edit1OnClick"/>
    <TfrxLabelControl Name="Label2" Left="12" Top="28" Width="60" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Periodo" Color="13948117"/>
    <TfrxDateEditControl Name="DateEdit1" Left="12" Top="52" Width="145" Height="21" Color="-16777211" Date="41862,5930237384" Time="41862,5930237384"/>
    <TfrxDateEditControl Name="DateEdit2" Left="228" Top="52" Width="145" Height="21" Color="-16777211" Date="41862,5930237384" Time="41862,5930237384"/>
    <TfrxLabelControl Name="Label4" Left="12" Top="104" Width="49" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Turma" Color="13948117"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="12" Top="124" Width="377" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
  </TfrxDialogPage>
</TfrxReport>
