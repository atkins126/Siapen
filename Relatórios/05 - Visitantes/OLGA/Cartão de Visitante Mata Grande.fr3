<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="6.9.15" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="45077,4294661574" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;  SqlListavisitante.Close;&#13;&#10;  SqlListavisitante.Open;&#13;&#10;&#13;&#10;  while not SqlListavisitante.EOF do&#13;&#10;  begin&#13;&#10;    ComboBoxvisitante.Items.Add(SqlListavisitante.FieldByName('visitante').AsString);&#13;&#10;    SqlListavisitante.Next;&#13;&#10;  end;&#13;&#10;&#13;&#10;  ComboBoxvisitante.setfocus;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;    SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;     ComboBoxvisitante.text := UpperCase(ComboBoxvisitante.text);&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport">
  <Datasets>
    <item DataSet="frxDBDataset1" DataSetName="frxDBDataset1"/>
    <item DataSet="sqlvisitante" DataSetName="sqlvisitante"/>
    <item DataSet="Sqlmenores" DataSetName="Sqlmenores"/>
    <item DataSet="sqllistavisitante" DataSetName="sqllistavisitante"/>
    <item DataSet="Sqlup" DataSetName="Sqlup"/>
    <item DataSet="DBXQuery1" DataSetName="DBXQuery1"/>
  </Datasets>
  <Variables>
    <item Name=" SIAP"/>
    <item Name="DATA_AGENDA"/>
    <item Name="GLOBAL_VISITANTE" Value="'R'"/>
    <item Name="ID_UP" Value="8011"/>
    <item Name="GLOBAL_ORGAO" Value="'GOVERNO DO ESTADO DE MATO GROSSO'"/>
    <item Name="GLOBAL_DEPARTAMENTO" Value="'SECRETARIA DE ESTADO DE JUSTIÇA E DIREITOS HUMANOS'"/>
    <item Name="GLOBAL_DIRETORIA" Value="'SECRETARIA ADJUNTA DE ADMINISTRAÇÃO PENITENCIÁRIA'"/>
  </Variables>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select distinct                        &#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.foto,                    &#13;&#10;    v.cpf,                    &#13;&#10;    coalesce(c.cidade||' - '||c.uf,'NÃO INFORMADO') as cidade,&#13;&#10;    (SELECT p.parentesco                    &#13;&#10;    FROM LISTAR_INTERNOS_PARA_VISITANTES (v.numero_carteirinha) p) as grau_parentesco,&#13;&#10;    (SELECT p.NOMESDOSVISITANTES&#13;&#10;    FROM LISTAR_INTERNOS_PARA_VISITANTES (v.numero_carteirinha) p) as nome_interno                                &#13;&#10;from  visitante_interno vi    &#13;&#10;inner join visitante v on (vi.id_visitante = v.id_visitante)&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join cidade c on (v.idcidade = c.id_cidade)&#13;&#10;where v.visitante = :visitante   and i.st = 'A' and i.id_up = :idup                                                                                                                                                                                                 &#13;&#10;                &#13;&#10;&#13;&#10;             " Database="Database" PropData="05704C65667402580470546F70025C0A506172616D657465727301010C49000000204E616D653D227669736974616E7465222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F787669736974616E74652E746578742200010C3E000000204E616D653D2269647570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlmenores" UserName="Sqlmenores" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select&#13;&#10;list(m.nome_menores||' - '||g.grau_parentesco,', ') menores                                       &#13;&#10;from visitante v&#13;&#10;left join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;left join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join menores m on (m.id_visitante = v.id_visitante)&#13;&#10;where visitante = :visitante    " Database="Database" PropData="05704C65667402540470546F700398000A506172616D657465727301010C49000000204E616D653D227669736974616E7465222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F787669736974616E74652E74657874220000"/>
    <TfrxDBXQuery Name="sqllistavisitante" UserName="sqllistavisitante" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select distinct v.visitante&#13;&#10;from visitante v&#13;&#10;inner join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)    &#13;&#10;where v.status = 'A' and i.id_up = :idup                                                                                                                                   &#13;&#10;order by v.visitante&#13;&#10;    &#13;&#10;    " Database="Database" PropData="05704C65667403E8000470546F70025C0A506172616D657465727301010C3E000000204E616D653D2269647570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403A0000470546F700398000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403A0000470546F70025C"/>
    <TfrxDBXQuery Name="DBXQuery1" UserName="DBXQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select&#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.foto,                    &#13;&#10;    v.cpf,                    &#13;&#10;    coalesce(c.cidade||' - '||c.uf,'NÃO INFORMADO') as cidade,&#13;&#10;    g.grau_parentesco,&#13;&#10;    i.nome_interno                         &#13;&#10;from  visitante v &#13;&#10;inner join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join cidade c on (v.idcidade = c.id_cidade)&#13;&#10;where v.visitante = :visitante                                                                                                                      &#13;&#10;group by&#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.cpf,&#13;&#10;    c.cidade||' - '||c.uf,&#13;&#10;    v.foto,  &#13;&#10;    g.grau_parentesco,&#13;&#10;    i.nome_interno        &#13;&#10;&#13;&#10;             " Database="Database" PropData="05704C65667402600470546F70031C010A506172616D657465727301010C49000000204E616D653D227669736974616E7465222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F787669736974616E74652E74657874220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" HGuides.Text="" VGuides.Text="" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" Columns="1" ColumnWidth="210" ColumnPositions.Text="0" Frame.Typ="0" MirrorMode="0" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageHeader Name="PageHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="37,7952755905512" Left="0" Top="18,89765" Width="793,7013"/>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="286,46324844" Left="0" Top="117,16543" Width="793,7013" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitante" DataSetName="sqlvisitante" RowCount="0">
      <TfrxShapeView Name="Shape2" AllowVectorExport="True" Left="393,07112" Top="0" Width="393,07112" Height="253,22833913" Frame.Typ="0"/>
      <TfrxShapeView Name="Shape1" AllowVectorExport="True" Left="0" Top="0" Width="393,07086614" Height="253,22833913" Frame.Typ="0"/>
      <TfrxMemoView Name="Memo3" AllowVectorExport="True" Left="104,60637" Top="37,23489222" Width="185,19697" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="5" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="Carteira Individual de Visitante"/>
      <TfrxPictureView Name="Picture1" Description="#FR3 clipboard#&#10;" AllowVectorExport="True" Left="287,90569" Top="59,35301222" Width="98,26765795" Height="94,48810354" Center="True" DataField="FOTO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Frame.ShadowWidth="0" Frame.Typ="15" Frame.LeftLine.Width="0" Frame.TopLine.Width="0" Frame.RightLine.Width="0" Frame.BottomLine.Width="0" KeepAspectRatio="False" HightQuality="False" Transparent="False" TransparentColor="16777215"/>
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="18,89765" Top="59,91207222" Width="268,34663" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" Text="Nome do Visitante"/>
      <TfrxMemoView Name="Memo6" AllowVectorExport="True" Left="18,89765" Top="124,16389671" Width="94,48825" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="FiliaÃ§Ã£o"/>
      <TfrxMemoView Name="Memo8" AllowVectorExport="True" Left="18,89765" Top="90,14801442" Width="128,50402" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="CPF"/>
      <TfrxMemoView Name="Memo21" AllowVectorExport="True" Left="147,40167" Top="90,1481023" Width="120,94496" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="1" ParentFont="False" Text="RG"/>
      <TfrxMemoView Name="Memo38" AllowVectorExport="True" Left="20,89765" Top="188,19546844" Width="370,39394" Height="52,91342" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Calibri" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="CARTEIRA VÃLIDA SOMENTE NO SISTEMA PENITENCIÃRIO DO MATO GROSSO&#13;&#10;NÃO Ã VALIDO COMO DOCUMENTO DE IDENTIDADE"/>
      <TfrxMemoView Name="Memo2" AllowVectorExport="True" Left="104,60637" Top="5,86479151" Width="185,19697" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]"/>
      <TfrxMemoView Name="sqlvisitanteCPF" AllowVectorExport="True" Left="527,01608" Top="23,11661844" Width="222,99227" Height="49,89765" StretchMode="smMaxHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;nome_interno&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteGRAU_PARENTESCO" AllowVectorExport="True" Left="18,89765" Top="101,48660442" Width="128,50394677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="10" ParentFont="False" Text="[sqlvisitante.&#34;CPF&#34;]"/>
      <TfrxMemoView Name="Memo4" AllowVectorExport="True" Left="400,51206" Top="186,16385033" Width="366,61441" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" Text="Expedido em:"/>
      <TfrxMemoView Name="Memo5" AllowVectorExport="True" Left="18,89765" Top="71,25066222" Width="268,34655677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;VISITANTE&#34;]"/>
      <TfrxMemoView Name="Memo7" AllowVectorExport="True" Left="146,40167" Top="101,48690222" Width="139,84253677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;RG&#34;]"/>
      <TfrxMemoView Name="Memo9" AllowVectorExport="True" Left="18,89765" Top="135,50267222" Width="249,44890677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;mae&#34;]"/>
      <TfrxMemoView Name="Memo10" AllowVectorExport="True" Left="18,89765" Top="150,62079222" Width="268,34655677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;pai&#34;]"/>
      <TfrxBarCodeView Name="BarCode1" AllowVectorExport="True" Left="525,57514" Top="100,13254222" Width="130" Height="68,03154" BarType="bcCode39" Expression="&#60;sqlvisitante.&#34;NUMERO_CARTEIRINHA&#34;&#62;" Frame.Typ="0" Rotation="0" TestLine="False" Text="12345678" WideBarRatio="2" Zoom="1" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="0" ColorBar="0"/>
      <TfrxMemoView Name="Memo11" AllowVectorExport="True" Left="489,77984" Top="186,80975151" Width="68,03154" Height="18,8976378" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[&#60;Date&#62;+2]"/>
      <TfrxPictureView Name="Picture3" AllowVectorExport="True" Left="322,33090344" Top="5,86479151" Width="43,84250553" Height="47,43954828" Frame.Typ="0" FileLink="..\logo\direita.jpg" HightQuality="False" Transparent="False" TransparentColor="16777215"/>
      <TfrxPictureView Name="Picture4" AllowVectorExport="True" Left="27,89765" Top="3,77953" Width="43,84250553" Height="47,43954828" Frame.Typ="0" FileLink="..\logo\esquerda.jpg" HightQuality="False" Transparent="False" TransparentColor="16777215"/>
      <TfrxMemoView Name="Memo22" AllowVectorExport="True" Left="399,77953" Top="4,52094484" Width="219,21274" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Parentesco:                             Nome do Interno"/>
      <TfrxMemoView Name="Memo13" AllowVectorExport="True" Left="399,63018" Top="24,67718" Width="83,14966" Height="47,57483" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;grau_parentesco&#34;]  "/>
      <TfrxMemoView Name="Memo14" AllowVectorExport="True" Left="647,29963" Top="185,19697" Width="136,06308" Height="22,6771678" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Calibri" Font.Style="1" Frame.Typ="0" ParentFont="False" VAlign="vaCenter" Text="[DATE] - [TIME]"/>
      <TfrxMemoView Name="Memo15" AllowVectorExport="True" Left="570,70903" Top="187,9765" Width="64,25201" Height="18,8976378" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" VAlign="vaCenter" Text="IMPRESSO:"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" DoubleBuffered="False" Height="158" ClientHeight="119" Left="283" Top="148" Width="500" Scaled="True" ClientWidth="484" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="20" Top="10" Width="85" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Visitante" Color="15854311" OnClick="Label1OnClick"/>
    <TfrxButtonControl Name="Button1" Left="286" Top="92" Width="75" Height="25" ShowHint="True" Caption="OK" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="394" Top="92" Width="75" Height="25" ShowHint="True" Caption="Cancelar" ModalResult="5"/>
    <TfrxComboBoxControl Name="ComboBoxvisitante" Left="21" Top="43" Width="449" Height="21" ShowHint="True" Color="-16777211" Items.Text="" ItemIndex="-1"/>
  </TfrxDialogPage>
</TfrxReport>
