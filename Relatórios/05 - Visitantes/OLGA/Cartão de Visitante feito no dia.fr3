<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="44937,4640036227" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;  DateEdit1.date := date;&#13;&#10;  DateEdit1.setfocus;                                          &#13;&#10;  {SqlListavisitante.Close;&#13;&#10;  SqlListavisitante.Open;     }  &#13;&#10;    &#13;&#10;{  while not SqlListavisitante.EOF do&#13;&#10;  begin&#13;&#10;    ComboBoxvisitante.Items.Add(SqlListavisitante.FieldByName('visitante').AsString);&#13;&#10;    SqlListavisitante.Next;&#13;&#10;  end;&#13;&#10;    &#13;&#10;  ComboBoxvisitante.setfocus;      }  &#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;    SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    { ComboBoxvisitante.text := UpperCase(ComboBoxvisitante.text);  }                                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3200000020446174615365743D2273716C7669736974616E74652220446174615365744E616D653D2273716C7669736974616E74652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C24000000204E616D653D22474C4F42414C5F5649534954414E5445222056616C75653D222752272200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;    v.id_visitante,                                                                 &#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.FOTO,                        &#13;&#10;    v.cpf,&#13;&#10;    v.DATA_CADASTRO,                        &#13;&#10;    coalesce(c.cidade||' - '||c.uf,'NÃO INFORMADO') as cidade,&#13;&#10;    g.grau_parentesco,&#13;&#10;    i.nome_interno&#13;&#10;from  visitante v &#13;&#10;inner join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join cidade c on (v.idcidade = c.id_cidade)&#13;&#10;where v.DATA_CADASTRO = :DATA1 and I.ID_UP = :ID_UP                                                                                                                                                                           &#13;&#10;group by&#13;&#10;    v.id_visitante,                                                             &#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.cpf,                    &#13;&#10;    c.cidade||' - '||c.uf,&#13;&#10;    v.FOTO,                        &#13;&#10;    v.DATA_CADASTRO,  &#13;&#10;    g.grau_parentesco,&#13;&#10;    i.nome_interno              &#13;&#10;order by&#13;&#10;    v.id_visitante                                                &#13;&#10;        &#13;&#10;             " Database="Database" PropData="05704C65667402540470546F70025C0A506172616D657465727301010C3B000000204E616D653D224441544131222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974312E646174652200010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403A0000470546F700398000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403A0000470546F70025C"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" Columns="1" ColumnWidth="210" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="264,5671" Left="0" Top="102,04731" Width="793,7013" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitante" DataSetName="sqlvisitante" RowCount="0">
      <TfrxShapeView Name="Shape2" Left="411,96877" Top="0" Width="411,96877" Height="264,5671"/>
      <TfrxShapeView Name="Shape1" ShiftMode="smWhenOverlapped" Left="0" Top="0" Width="411,96877" Height="264,5671"/>
      <TfrxPictureView Name="Picture2" Left="26,45671" Top="3,77953" Width="43,84250553" Height="47,43954828" FileLink="..\logo\esquerda.jpg"/>
      <TfrxMemoView Name="Memo13" Left="90,70872" Top="3,77953" Width="207,87415" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]"/>
      <TfrxPictureView Name="Picture5" Left="325,03958" Top="3,77953" Width="43,84250553" Height="47,43954828" FileLink="..\logo\direita.jpg"/>
      <TfrxMemoView Name="Memo14" Left="90,70872" Top="37,7953" Width="207,87415" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" Text="Carteira Individual de Visitante"/>
      <TfrxMemoView Name="Memo15" Left="26,45671" Top="64,25201" Width="268,34663" Height="11,33859" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" Text="Nome do Visitante"/>
      <TfrxMemoView Name="Memo16" Left="26,45671" Top="79,37013" Width="268,34655677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;VISITANTE&#34;]"/>
      <TfrxPictureView Name="Picture6" Description="#FR3 clipboard#&#10;" Left="294,80334" Top="64,25201" Width="102,04718795" Height="102,04716354" Center="True" DataField="FOTO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Frame.Typ="15" KeepAspectRatio="False"/>
      <TfrxMemoView Name="Memo18" Left="26,45671" Top="102,04731" Width="128,50402" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="CPF"/>
      <TfrxMemoView Name="Memo20" Left="26,45671" Top="117,16543" Width="128,50394677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="10" ParentFont="False" Text="[sqlvisitante.&#34;CPF&#34;]"/>
      <TfrxMemoView Name="Memo23" Left="154,96073" Top="102,04731" Width="120,94496" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="1" ParentFont="False" Text="RG"/>
      <TfrxMemoView Name="Memo24" Left="154,96073" Top="117,16543" Width="139,84253677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;RG&#34;]"/>
      <TfrxMemoView Name="Memo25" Left="26,45671" Top="139,84261" Width="94,48825" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="FiliaÃ§Ã£o"/>
      <TfrxMemoView Name="Memo26" Left="26,45671" Top="158,74026" Width="249,44890677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;mae&#34;]"/>
      <TfrxMemoView Name="Memo27" Left="26,45671" Top="177,63791" Width="268,34655677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;pai&#34;]"/>
      <TfrxMemoView Name="Memo28" Left="45,35436" Top="200,31509" Width="336,37817" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Calibri" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="CARTEIRA VALIDÃ SOMENTE NO SISTEMA PENITENCIÃRIO DO MATO GROSSO&#13;&#10;NÃO Ã VALIDO COMO DOCUMENTO DE IDENTIDADE"/>
      <TfrxMemoView Name="Memo29" Left="423,30736" Top="11,33859" Width="105,82684" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="Parentesco:"/>
      <TfrxMemoView Name="Memo30" Left="423,30736" Top="37,7953" Width="362,83488" Height="22,67718" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;grau_parentesco&#34;]"/>
      <TfrxBarCodeView Name="BarCode2" Left="529,1342" Top="71,81107" Width="129" Height="71,81107" BarType="bcCode39" Expression="&#60;sqlvisitante.&#34;NUMERO_CARTEIRINHA&#34;&#62;" Rotation="0" Text="12345678" WideBarRatio="2" Zoom="1"/>
      <TfrxMemoView Name="Memo31" Left="419,52783" Top="158,74026" Width="90,70872" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" VAlign="vaCenter" Text="Expedido em:"/>
      <TfrxMemoView Name="Memo32" Left="500,787725" Top="158,74026" Width="71,81107" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="[Date]"/>
      <TfrxMemoView Name="Memo33" Left="634,96104" Top="158,74026" Width="154,96073" Height="18,8976378" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="[DATE] - [TIME]"/>
      <TfrxMemoView Name="Memo1" Left="570,70903" Top="158,74026" Width="64,25201" Height="18,8976378" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="IMPRESSO:"/>
      <TfrxMemoView Name="Memo2" Left="529,1342" Top="11,33859" Width="117,16543" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Times New Roman" Font.Style="1" ParentFont="False" Text="Nome do Interno"/>
      <TfrxMemoView Name="Memo3" Left="529,1342" Top="37,7953" Width="362,83488" Height="22,67718" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;nome_interno&#34;]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="22,67718" Left="0" Top="18,89765" Width="793,7013"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="158" Left="283" Top="146" Width="483" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="22" Top="88" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="110" Top="88" Width="75" Height="25" Caption="Cancelar" ModalResult="5"/>
    <TfrxDateEditControl Name="DateEdit1" Left="20" Top="52" Width="221" Height="21" Color="-16777211" Date="41600,6150388889" Time="41600,6150388889"/>
    <TfrxLabelControl Name="Label1" Left="20" Top="16" Width="214" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="Carteirinhas feitas no dia:" Color="-16777201" OnClick="Label1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
