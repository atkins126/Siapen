<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="43298,514680162" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; memo11.text :='RELAÇÃO DE MUDANÇAS DE CELA - PERÍODO   '+ '' +''+'   a   '+''+'';                                                                                   &#13;&#10; memo3.text := 'Brasília-DF, '&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;    sqlgaleria.Open;&#13;&#10;     &#13;&#10;  while not sqlgaleria.EOF do&#13;&#10;  begin&#13;&#10;    //ComboBox1.Items.Add(sqlgaleria.FieldByName('GALERIA').AsString);&#13;&#10;    ComboBox2.Items.Add(sqlgaleria.FieldByName('GALERIA').AsString);        &#13;&#10;    sqlgaleria.Next;&#13;&#10;  end;&#13;&#10;           &#13;&#10;                           &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure ComboBox2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2E00000020446174615365743D2253716C436F6E666572652220446174615365744E616D653D2253716C436F6E666572652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3800000020446174615365743D2273716C4C69737461496E7465726E6F2220446174615365744E616D653D2273716C4C69737461496E7465726E6F2200010C2E00000020446174615365743D2273716C67616C657269612220446174615365744E616D653D2273716C67616C65726961220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C17000000204E616D653D22474C4F42414C5F4A555249444943412200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667402280470546F70021C"/>
    <TfrxDBXQuery Name="SqlConfere" UserName="SqlConfere" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    interno.nome_interno,  &#13;&#10;    interno.rgi,                              &#13;&#10;    mudanca_cela.Confirmada,&#13;&#10;    mudanca_cela.data,                        &#13;&#10;    mudanca_cela.motivo_movimentacao,                                                                          &#13;&#10;    ga.galeria as galeriaAntes, sa.solario as SolarioAntes, ca.cela as celaAntes,&#13;&#10;    gn.galeria as galeriaNovo, sn.solario as solarioNovo, cn.cela as celaNovo        &#13;&#10;          &#13;&#10;FROM mudanca_cela&#13;&#10;  &#13;&#10;INNER JOIN vinc_mudanca_cela ON (vinc_mudanca_cela.id_mudanca_cela = mudanca_cela.id_mudanca_cela)    &#13;&#10;INNER JOIN interno ON (interno.id_interno = vinc_mudanca_cela.id_interno)&#13;&#10;  &#13;&#10;INNER JOIN pavilhao pa on (vinc_mudanca_cela.id_pavilhao_antes = pa.id_pavilhao)&#13;&#10;INNER JOIN galeria ga on (vinc_mudanca_cela.id_galeria_antes = ga.id_galeria)&#13;&#10;INNER JOIN solario sa on (vinc_mudanca_cela.id_solario_antes = sa.id_solario)&#13;&#10;INNER JOIN cela ca on (vinc_mudanca_cela.id_cela_antes=ca.id_cela)&#13;&#10;INNER JOIN pavilhao pn on (vinc_mudanca_cela.id_pavilhao_novo = pn.id_pavilhao)&#13;&#10;INNER JOIN galeria gn on (vinc_mudanca_cela.id_galeria_novo = gn.id_galeria)&#13;&#10;INNER JOIN solario sn on (vinc_mudanca_cela.id_solario_novo = sn.id_solario)&#13;&#10;INNER JOIN cela cn on (vinc_mudanca_cela.id_cela_novo = cn.id_cela)&#13;&#10;INNER JOIN pavilhao ph on (pn.id_pavilhao = interno.idpavilhao)&#13;&#10;INNER JOIN galeria gh on (gn.id_galeria = interno.idgaleria)&#13;&#10;INNER JOIN solario sh on (sn.id_solario = interno.idsolario)&#13;&#10;INNER JOIN cela ch on (cn.id_cela = interno.idcela)                                                                                                                   &#13;&#10;  &#13;&#10;WHERE &#13;&#10;/*cast(extract (day from mudanca_cela.data) || '.' ||&#13;&#10;//          extract (month from mudanca_cela.data) || '.' ||&#13;&#10;//           extract (year from mudanca_cela.data) as date)BETWEEN  data1 and  data      */  &#13;&#10; mudanca_cela.ID_UP = :ID_UP&#13;&#10;AND mudanca_cela.confirmada = 'S'&#13;&#10;AND ga.galeria like '%' || :bloco || '' &#13;&#10;AND pn.pavilhao = ph.pavilhao&#13;&#10;and gn.galeria = gh.galeria&#13;&#10;and sn.solario = sh.solario&#13;&#10;and cn.cela = ch.cela                                                  &#13;&#10;&#13;&#10;Order by mudanca_cela.data desc, galeriaantes,solarioantes, celaantes,galerianovo, solarionovo, celanovo                                                                                                                                                                                                                                                                " Database="Database" PropData="05704C65667402780470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3D000000204E616D653D22626C6F636F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78322E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403D4000470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlListaInterno" UserName="sqlListaInterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;I.nome_interno,&#13;&#10;i.id_interno                          &#13;&#10;from interno i    &#13;&#10;where I.ID_UP = :ID_UP&#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;order by i.nome_interno  " Database="Database" PropData="05704C6566740328010470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlgaleria" UserName="sqlgaleria" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;     g.galeria&#13;&#10;from  galeria g&#13;&#10;join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;&#13;&#10;where p.id_up =:ID_UP&#13;&#10;order by g.galeria  " Database="Database" PropData="05704C6566740388010470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="149,62214" Left="0" ParentFont="False" Top="16" Width="1009,13451">
      <TfrxMemoView Name="Memo2" Left="151,1812" Top="79,37013" Width="718,1107" Height="45,35436" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="3,77953" Top="124,72449" Width="997,79592" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="18,89765" Left="0" ParentFont="False" Top="228" Width="1009,13451" ColumnWidth="0" ColumnGap="0" DataSet="SqlConfere" DataSetName="SqlConfere" RowCount="0">
      <TfrxMemoView Name="Memo16" Left="30,23624" Top="0" Width="306,14193" Height="18,8976378" DataSet="SqlConfere" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Color="8388608" Frame.Typ="15" ParentFont="False" Text="[Sqlconfere.&#34;NOME_INTERNO&#34;] - [Sqlconfere.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="336,37817" Top="0" Width="83,14966" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sqlconfere.&#34;DATA&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="419,52783" Top="0" Width="268,34663" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sqlconfere.&#34;MOTIVO_MOVIMENTACAO&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="687,87446" Top="0" Width="162,51979" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sqlconfere.&#34;galeriaantes&#34;] - [sqlconfere.&#34;solarioantes&#34;] - [sqlconfere.&#34;celaantes&#34;]"/>
      <TfrxMemoView Name="Memo15" Left="850,39425" Top="0" Width="158,74026" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[sqlconfere.&#34;galerianovo&#34;] - [sqlconfere.&#34;solarionovo&#34;] - [sqlconfere.&#34;celanovo&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="0" Top="0" Width="30,23624" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[LINE]"/>
    </TfrxMasterData>
    <TfrxColumnHeader Name="ColumnHeader1" Height="22,67718" Left="0" Top="184" Width="1009,13451">
      <TfrxMemoView Name="Memo7" Left="851,39425" Top="0" Width="158,74026" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Para :"/>
      <TfrxMemoView Name="Memo10" Left="687,87446" Top="0" Width="162,51979" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="De :"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="336,37817" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Interno"/>
      <TfrxMemoView Name="Memo4" Left="419,52783" Top="0" Width="268,34663" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Motivo :"/>
      <TfrxMemoView Name="Memo8" Left="336,37817" Top="0" Width="83,14966" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Data :"/>
    </TfrxColumnHeader>
    <TfrxPageFooter Name="PageFooter1" Height="30,23624" Left="0" Top="392" Width="1009,13451">
      <TfrxMemoView Name="Memo19" Left="328,81911" Top="3,77953" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxPictureView Name="Picture4" Left="8,55906" Top="9,67717512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    <TfrxMemoView Name="Memo1" Left="143,62214" Top="15,11812" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
    <TfrxPictureView Name="Picture3" Left="876,85096976" Top="12,67718" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
    <TfrxFooter Name="Footer1" Height="102,04731" Left="0" Top="268" Width="1009,13451">
      <TfrxMemoView Name="Memo3" Left="642,5201" Top="77,81107" Width="351,49629" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo6" Left="26,45671" Top="79,37013" Width="283,46475" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="Chefe de PÃ¡tio"/>
    </TfrxFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="234" Left="265" Top="154" Width="515" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="8" Top="8" Width="523" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="SELECIONE O BLOCO OU DEIXE EM BRANCO QUE TRARÁ TODAS AS MUDANÇAS" Color="13948117"/>
    <TfrxButtonControl Name="Button1" Left="388" Top="148" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1"/>
    <TfrxComboBoxControl Name="ComboBox2" Left="6" Top="72" Width="145" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox2OnClick"/>
    <TfrxLabelControl Name="Label7" Left="6" Top="51" Width="74" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Bloco Atual" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
