<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="42814,5748535995" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;  SqlListaInterno.Open;&#13;&#10;  while not SqlListaInterno.EOF do&#13;&#10;  begin&#13;&#10;       comboInterno.Items.Add(SqlListaInterno.FieldByName('nome_interno').AsString);&#13;&#10;       SqlListaInterno.Next;                                                   &#13;&#10;  end;            &#13;&#10;  {Sqlgaleria.Open;&#13;&#10;  while not SqlListaInterno.EOF do&#13;&#10;  begin&#13;&#10;    comboboxreeducando.Items.Add(SqlListaInterno.FieldByName('nome_interno').AsString);&#13;&#10;    SqlListaInterno.Next;&#13;&#10;  end;                          &#13;&#10;  SqlDiretor.Open;&#13;&#10;  Edit2.Text:=SqlDiretor.FieldByName('nome_funcionario').AsString;&#13;&#10;  Edit1.Text:=SqlDiretor.FieldByName('funcao').AsString;&#13;&#10;  SqlDiretor.Close;                                      &#13;&#10;  Sqlroupas.Open;&#13;&#10;  while not SqlRoupas.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlRoupas.FieldByName('vestimentas').AsString);&#13;&#10;    SqlRoupas.Next;                                        &#13;&#10;  end;            &#13;&#10;  comboboxreeducando.setfocus; }                                               &#13;&#10;end;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  IF &#60;GLOBAL_CONFERE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;    SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;  &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure btnOkOnEnter(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   { comboboxreeducando.text:=uppercase(comboboxreeducando.text)}                                                                      &#13;&#10;end;&#13;&#10;&#13;&#10;{procedure comboboxreeducandoOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Sqlroupas.Open;&#13;&#10; ComboBox1.Items.Clear;                                                   &#13;&#10; while not SQLroupas.EOF do&#13;&#10; begin&#13;&#10;       //ComboBox1.Items.Add(SqlRoupas.FieldByName('VESTIMENTAS').AsString + ' Quantidade: '+                               &#13;&#10;       //SqlRoupas.FieldByName('QTDE').AsString + ', Data: ' + SqlRoupas.FieldByName('DATA').AsString);&#13;&#10;       ComboBox1.Items.Add(SqlRoupas.FieldByName('VESTIMENTAS').AsString + ' Quantidade: '+                               &#13;&#10;       SqlRoupas.FieldByName('QTDE').AsString);         &#13;&#10;       SqlRoupas.Next;&#13;&#10;       //[SqlRoupas.&#34;VESTIMENTAS&#34;] - Qtde: [SqlRoupas.&#34;QTDE&#34;] em [SqlRoupas.&#34;DATA&#34;]           &#13;&#10; end;&#13;&#10; SqlRoupas.Close;                                   &#13;&#10;end;&#13;&#10; }  &#13;&#10;procedure ListBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C2C00000020446174615365743D2253716C526F757061732220446174615365744E616D653D2253716C526F757061732200010C3800000020446174615365743D2273716C556E696461646550656E616C2220446174615365744E616D653D2273716C556E696461646550656E616C2200010C3100000020446174615365743D2253716C47616C657269612220446174615365744E616D653D2253716C526565647563616E646F2200010C3800000020446174615365743D2273716C4C69737461696E7465726E6F2220446174615365744E616D653D2273716C4C69737461696E7465726E6F2200010C3600000020446174615365743D2253716C4175746F72697A6163616F2220446174615365744E616D653D2253716C4175746F72697A6163616F2200010C2E00000020446174615365743D2273716C64697265746F722220446174615365744E616D653D2273716C64697265746F722200010C3800000020446174615365743D2253716C4175746F72697A6163616F362220446174615365744E616D653D2253716C4175746F72697A6163616F36220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C17000000204E616D653D22474C4F42414C5F4A555249444943412200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C13000000204E616D653D22444154415F494E4943494F2200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C656674039C000470546F70021C"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403F0000470546F70021C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlRoupas" UserName="SqlRoupas" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10; v.vestimentas     &#13;&#10;from vestimentas v  &#13;&#10;order by v.vestimentas                                                            &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                                                   " Database="Database" PropData="05704C65667403F0000470546F7002700A506172616D65746572730100"/>
    <TfrxDBXQuery Name="sqlUnidadePenal" UserName="sqlUnidadePenal" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select nome_up from unidade_penal&#13;&#10;where id_up = :id_up  " Database="Database" PropData="05704C65667402440470546F70021C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlGaleria" UserName="SqlReeducando" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria    " Database="Database" PropData="05704C65667402440470546F7002700A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlListainterno" UserName="sqlListainterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;i.nome_interno,&#13;&#10;i.RGI,                            &#13;&#10;i.id_interno                          &#13;&#10;from interno i    &#13;&#10;where I.ID_UP = :ID_UP and i.ST = 'A'                                 &#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;order by i.nome_interno  " Database="Database" PropData="05704C656674039C000470546F7002700A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlAutorizacao" UserName="SqlAutorizacao" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10; i.nome_interno, v.vestimentas,ri.qtde, r.data, g.galeria, s.solario                                                                                                                                                     &#13;&#10;from roupas_interno ri&#13;&#10;inner join roupas  r on (r.id_roupas = ri.id_roupa)                                                                                                                                  &#13;&#10;inner join vestimentas v on(ri.id_vestimentas = v.id_vestimentas)&#13;&#10;inner join interno i on (r.ID_INTERNO = i.ID_interno)&#13;&#10;inner join unidade_penal up on (i.id_up = up.id_up)&#13;&#10;inner join solario s on (i.idsolario = s.id_solario)&#13;&#10;inner join galeria g on (i.idgaleria = g.id_galeria)&#13;&#10;inner join cela c on (i.idcela = c.id_cela)    &#13;&#10;where i.nome_interno = :Interno and Datediff(Month, r.data, current_timestamp) &#60; 6                                                                                                                                                                                                                                                                &#13;&#10;order by i.nome_interno, r.data                                                                                                                      &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                                                   " Database="Database" PropData="05704C65667402400470546F7003C4000A506172616D657465727301010C42000000204E616D653D22496E7465726E6F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F496E7465726E6F2E74657874220000"/>
    <TfrxDBXQuery Name="sqldiretor" UserName="sqldiretor" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT f.nome_funcionario, f.funcao &#13;&#10;FROM funcionario f &#13;&#10;&#13;&#10;where f.id_up = :ID_UP&#13;&#10;and f.funcao like 'DIRETOR'  " Database="Database" PropData="05704C656674039C000470546F7003C0000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlAutorizacao6" UserName="SqlAutorizacao6" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10; i.nome_interno, v.vestimentas,ri.qtde, r.data, g.galeria, s.solario                                                                                                                                                     &#13;&#10;from roupas_interno ri&#13;&#10;inner join roupas  r on (r.id_roupas = ri.id_roupa)                                                                                                                                  &#13;&#10;inner join vestimentas v on(ri.id_vestimentas = v.id_vestimentas)&#13;&#10;inner join interno i on (r.ID_INTERNO = i.ID_interno)&#13;&#10;inner join unidade_penal up on (i.id_up = up.id_up)&#13;&#10;inner join solario s on (i.idsolario = s.id_solario)&#13;&#10;inner join galeria g on (i.idgaleria = g.id_galeria)&#13;&#10;inner join cela c on (i.idcela = c.id_cela)    &#13;&#10;where i.nome_interno = :Interno and Datediff(Month, r.data, current_timestamp) &#62; 6                                                                                                                                                                                                                                                                &#13;&#10;order by i.nome_interno, r.data desc                                                                                                                                 &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                                                   " Database="Database" PropData="05704C656674023E0470546F7003FF000A506172616D657465727301010C42000000204E616D653D22496E7465726E6F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F496E7465726E6F2E74657874220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="502,67749" Width="680,3154">
      <TfrxMemoView Name="Memo19" Left="172,07885" Top="0,57483" Width="502,67749" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Height="20,67718" Left="0" Top="328,81911" Width="680,3154" ColumnWidth="0" ColumnGap="0" DataSet="SqlAutorizacao" DataSetName="SqlAutorizacao" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="205,98454" Top="1,77953" Width="131,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao.&#34;QTDE&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="8,88992" Top="1,77953" Width="188,9765" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao.&#34;vestimentas&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="352" Top="1,77952756" Width="89,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao.&#34;data&#34;]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="177,53556" Left="0" Top="18,89765" Width="680,3154">
      <TfrxMemoView Name="Memo3" Left="4,44094" Top="119,94496" Width="668,3154" Height="30,23624" Color="16777215" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" Text="ENTRADA DE ROUPAS"/>
      <TfrxMemoView Name="Memo1" Left="-45,35436" Top="0" Width="718,1107" Height="56,69295" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture4" Left="15,11812" Top="15,11812" Width="102,04723921" Height="98,26771165" FileLink="..\logo\esquerda.jpg"/>
      <TfrxPictureView Name="Picture3" Left="578,26809" Top="11,33859" Width="94,48817921" Height="94,48818165" FileLink="..\logo\direita.jpg"/>
    </TfrxPageHeader>
    <TfrxGroupHeader Name="GroupHeader1" Height="49,67718" Left="0" Top="257,00804" Width="680,3154" Condition="SqlAutorizacao.&#34;nome_interno&#34;">
      <TfrxMemoView Name="Memo2" Left="7,55906" Top="0,13389" Width="230,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao.&#34;Nome_interno&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="206,98454" Top="25,07081" Width="131,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Quantidade"/>
      <TfrxMemoView Name="Memo7" Left="8,88992" Top="25,07081" Width="188,9765" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Roupa"/>
      <TfrxMemoView Name="Memo9" Left="352" Top="24,09431" Width="82,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Data"/>
      <TfrxMemoView Name="Memo4" Left="247" Top="0,09431" Width="230,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[SqlAutorizacao.&#34;galeria&#34;] - [SqlAutorizacao.&#34;Solario&#34;]"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData2" Height="20,67718" Left="0" Top="419,52783" Width="680,3154" ColumnWidth="0" ColumnGap="0" DataSet="SqlAutorizacao6" DataSetName="SqlAutorizacao6" RowCount="0">
      <TfrxMemoView Name="Memo12" Left="205,98454" Top="1,77953" Width="131,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao6.&#34;QTDE&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="8,88992" Top="1,77953" Width="188,9765" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao6.&#34;vestimentas&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="352" Top="1,77952756" Width="89,55133" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[SqlAutorizacao6.&#34;data&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader2" Height="23,67718" Left="0" Top="374,17347" Width="680,3154" Condition="SqlAutorizacao6.&#34;Nome_interno&#34;">
      <TfrxMemoView Name="Memo11" Left="9" Top="0,7953" Width="666,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Anterior a 6 meses"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Informe o Nome do reeducando" Height="155" Left="400" Top="139" Width="416" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="btnOk" Left="8" Top="88" Width="75" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="OK" Default="True" ModalResult="1" OnClick="DialogPage1OnShow" OnEnter="btnOkOnEnter"/>
    <TfrxLabelControl Name="Label1" Left="8" Top="12" Width="51" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Caption="Nome:" Color="13948117" OnClick="Label4OnClick"/>
    <TfrxButtonControl Name="Button1" Left="124" Top="88" Width="75" Height="25" Caption="Cancelar" ModalResult="2"/>
    <TfrxComboBoxControl Name="ComboInterno" Left="9" Top="41" Width="373" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
  </TfrxDialogPage>
</TfrxReport>
