<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="40977,5126441088" ScriptLanguage="PascalScript" ScriptText.Text="procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DBLookupComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Database.Params.LoadFromFile('..\config\dbxconnections.ini');        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F00003546F7003880008446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3200000020446174615365743D2273716C7669736974616E74652220446174615365744E616D653D2273716C7669736974616E74652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C14000000204E616D653D22474C4F42414C5F4F5247414F2200010C1B000000204E616D653D22474C4F42414C5F444550415254414D454E544F2200010C18000000204E616D653D22474C4F42414C5F44495245544F5249412200010C24000000204E616D653D22474C4F42414C5F5649534954414E5445222056616C75653D222752272200010C19000000204E616D653D2249445F5550222056616C75653D22333031220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select * from (&#13;&#10;select 'Visita' tipo,v.visitante as nome, v.cpf, v.rg, v.mae, i.nome_interno,&#13;&#10;g.grau_parentesco&#13;&#10;from visitante_interno vi&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join visitante v on (v.id_visitante = vi.id_visitante)&#13;&#10;inner join grau_parentesco g on (g.id_grau_parentesco = vi.id_grau_parentesco)&#13;&#10;where i.id_up = :id_up&#13;&#10;union all&#13;&#10;select 'Menor' tipo,m.nome_menores as nome, v.cpf, v.rg, v.mae, i.nome_interno,&#13;&#10;g.grau_parentesco&#13;&#10;from visitante_interno vi&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join visitante v on (v.id_visitante = vi.id_visitante)&#13;&#10;inner join menores m on (m.id_visitante = v.id_visitante)&#13;&#10;inner join grau_parentesco g on (g.id_grau_parentesco = m.id_grau_parentesco)&#13;&#10;where i.id_up = :id_up&#13;&#10;) as visitas&#13;&#10;order by nome                                    " Database="Database" PropData="05704C65667402580470546F70025C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403D8000470546F70025C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667403A0000470546F70025C"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="200,31509" Left="0" ParentFont="False" Top="16" Width="718,1107" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="177,63791" Width="718,11023622" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="LISTAGEM DE VISITANTES"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="70,81107" Width="718,11023622" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture2" Left="332,59864" Top="7,55906" Width="60,47248" Height="60,47248" FileLink="..\logo\brasil.jpg"/>
      <TfrxMemoView Name="Memo40" Left="0" Top="131,28355" Width="718,110236220472" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxMemoView Name="Memo4" Align="baClient" Left="0" Top="0" Width="718,1107" Height="200,31509" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="384" Width="718,1107">
      <TfrxMemoView Name="Memo46" Align="baClient" Left="0" Top="0" Width="718,1107" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAP, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Height="22,67718" Left="0" Top="288" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitante" DataSetName="sqlvisitante" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Align="baClient" Left="0" Top="0" Width="718,1107" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="sqlvisitanteVISITANTE" Left="45,35436" Top="3,77953" Width="219,21274" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;nome&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteNOME_INTERNO" Left="480,00031" Top="3,77953" Width="238,11039" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteOBSERVACAO" Left="393,07112" Top="3,77953" Width="86,92906795" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;cpf&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="0" Top="3,77953" Width="49,13389" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[sqlvisitante.&#34;tipo&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="264,5671" Top="3,77953" Width="128,50389795" Height="18,89765" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;GRAU_PARENTESCO&#34;]"/>
    </TfrxMasterData>
    <TfrxColumnHeader Name="ColumnHeader1" Height="30,23624" Left="0" Top="236" Width="718,1107">
      <TfrxMemoView Name="Memo1" Align="baClient" Left="0" Top="0" Width="718,1107" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo6" Left="45,35436" Top="11,33859" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="Visitante "/>
      <TfrxMemoView Name="Memo18" Left="480,75621063" Top="7,55906" Width="83,14966" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="Interno"/>
      <TfrxMemoView Name="Memo7" Left="393,07112" Top="7,55906" Width="79,37013" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="CPF:"/>
      <TfrxMemoView Name="Memo8" Left="3,77953" Top="11,33859" Width="37,7953" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Tipo"/>
      <TfrxMemoView Name="Memo11" Left="264,5671" Top="7,55906" Width="98,26778" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="PARENTESCO:"/>
    </TfrxColumnHeader>
    <TfrxReportSummary Name="ReportSummary1" Height="30,23624" Left="0" Top="332" Width="718,1107">
      <TfrxMemoView Name="Memo9" Align="baClient" Left="0" Top="0" Width="718,1107" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" VAlign="vaBottom" Text="TOTAL DE VISITANTES: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
  </TfrxReportPage>
</TfrxReport>
