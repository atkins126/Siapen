<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="2022.1.3" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="45098,4188284722" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;var&#13;&#10; Nome:String;&#13;&#10; Funcao:String;&#13;&#10;&#13;&#10;&#13;&#10;function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10; DateEdit1.Date := date ;&#13;&#10; DateEdit2.Date := date+30;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DBLookupComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; memo1.Memo.Text := 'PERÍODO: ' + datetostr(DateEdit1.Date) + ' a ' + datetostr(DateEdit2.Date) ;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport">
  <Datasets>
    <item DataSet="frxDBDataset1" DataSetName="frxDBDataset1"/>
    <item DataSet="sqlvisitante" DataSetName="sqlvisitante"/>
    <item DataSet="sqllistavisitante" DataSetName="sqllistavisitante"/>
    <item DataSet="Sqlup" DataSetName="Sqlup"/>
    <item DataSet="SqlVivencia" DataSetName="SqlVivencia"/>
  </Datasets>
  <Variables>
    <item Name=" SIAP"/>
    <item Name="DATA_AGENDA"/>
    <item Name="GLOBAL_VISITANTE" Value="'R'"/>
    <item Name="ID_UP" Value="8011"/>
    <item Name="GLOBAL_ORGAO" Value="'GOVERNO DO ESTADO DE MATO GROSSO'"/>
    <item Name="GLOBAL_DEPARTAMENTO" Value="'SECRETARIA DE ESTADO DE JUSTIÇA E DIREITOS HUMANOS'"/>
    <item Name="GLOBAL_DIRETORIA" Value="'SECRETARIA ADJUNTA DE ADMINISTRAÇÃO PENITENCIÁRIA'"/>
  </Variables>
  <TfrxDataPage Name="Data" HGuides.Text="" VGuides.Text="" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" DataSetOptions="0" IgnoreDupParams="False" SQL.Text="select v.visitante, a.idagenda_atendimento,&#13;&#10;v.rg, i.nome_interno, aa.descricao, g.grau_parentesco,&#13;&#10;c.cela, a.observacao                               &#13;&#10;from agenda_atendimento a&#13;&#10;left join visitante v on (a.id_visitante = v.id_visitante)&#13;&#10;left join interno i on (a.id_interno = i.id_interno)&#13;&#10;left join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;left join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join agenda_assuntos aa on (a.idagenda_assuntos = aa.idagenda_assuntos)&#13;&#10;left join agenda_situacao s on (a.idagenda_situacao = s.idagenda_situacao)&#13;&#10;left join cela c on (i.idcela = c.id_cela)&#13;&#10;left join pavilhao p on (p.id_pavilhao = i.idpavilhao)    &#13;&#10;where v.data_cadastro between :data and :data1&#13;&#10;and a.id_up = :id_up and s.descricao like 'ATIVO' &#13;&#10;order by a.data_agenda, i.nome_interno&#13;&#10;&#13;&#10;                                    " Database="Database" PropData="05704C656674025B0470546F70024D0A506172616D65746572730101063A204E616D653D2264617461222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974312E64617465220001063B204E616D653D226461746131222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974322E64617465220001063F204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqllistavisitante" UserName="sqllistavisitante" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" DataSetOptions="0" IgnoreDupParams="False" SQL.Text="select visitante&#13;&#10;from visitante v&#13;&#10;order by visitante&#13;&#10;    &#13;&#10;    " Database="Database" PropData="05704C65667402580470546F700398000A506172616D65746572730100"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" DataSetOptions="0" IgnoreDupParams="False" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403A0000470546F700398000A506172616D65746572730101063F204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667403A0000470546F70025C"/>
    <TfrxDBXQuery Name="SqlVivencia" UserName="SqlVivencia" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" DataSetOptions="0" IgnoreDupParams="False" SQL.Text="select pavilhao from pavilhao&#13;&#10;where id_up = :id_up                                             &#13;&#10;order by pavilhao                    " Database="Database" PropData="05704C65667402580470546F7003DC000A506172616D65746572730101063F204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" HGuides.Text="" VGuides.Text="" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" Frame.Typ="0" MirrorMode="0" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="230,55133" Left="0" ParentFont="False" Top="18,89765" Width="1046,92981" Stretched="True">
      <TfrxMemoView Name="Memo3" AllowVectorExport="True" Left="0" Top="177,63791" Width="1046,92981" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="12" HAlign="haCenter" ParentFont="False" Text="RELAÇÃO DE VISITANTES"/>
      <TfrxMemoView Name="Memo2" AllowVectorExport="True" Left="3,77953" Top="70,81107" Width="1043,15028" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture2" AllowVectorExport="True" Left="495,11843" Top="3,77953" Width="60,47248" Height="60,47248" Frame.Typ="0" FileLink="..\logo\brasil.jpg" HightQuality="False" Transparent="False" TransparentColor="16777215"/>
      <TfrxMemoView Name="Memo40" AllowVectorExport="True" Left="3,77953" Top="131,28355" Width="1043,15028" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxMemoView Name="Memo1" AllowVectorExport="True" Left="0" Top="207,87415" Width="1046,92981" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="VALIDADO PELO CODE"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="26,45671" Left="0" Top="502,67749" Width="1046,92981">
      <TfrxMemoView Name="Memo46" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAP, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="26,45671" Left="0" Top="362,83488" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitante" DataSetName="sqlvisitante" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="sqlvisitanteVISITANTE" AllowVectorExport="True" Left="0" Top="3,77953" Width="211,65368" Height="18,89765" StretchMode="smActualHeight" DataField="VISITANTE" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;VISITANTE&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteRG" AllowVectorExport="True" Left="445,98454" Top="3,77953" Width="86,92914118" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" WordWrap="False" Text="RG: [sqlvisitante.&#34;RG&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteIDAGENDA_ATENDIMENTO" AllowVectorExport="True" Left="532,91373" Top="3,77953" Width="52,91342" Height="18,89765" DataField="IDAGENDA_ATENDIMENTO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[sqlvisitante.&#34;IDAGENDA_ATENDIMENTO&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteNOME_INTERNO" AllowVectorExport="True" Left="589,60668" Top="3,77953" Width="200,31509" Height="18,89765" StretchMode="smActualHeight" DataField="NOME_INTERNO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteCELA" AllowVectorExport="True" Left="793,7013" Top="3,77953" Width="75,59052677" Height="18,89765" DataField="CELA" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" HAlign="haCenter" ParentFont="False" Text="[sqlvisitante.&#34;CELA&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteDESCRICAO" AllowVectorExport="True" Left="865,51237" Top="3,77953" Width="83,14961118" Height="18,89765" DataField="DESCRICAO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;DESCRICAO&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteGRAU_PARENTESCO" AllowVectorExport="True" Left="948,66203" Top="3,77953" Width="90,70867118" Height="18,89765" DataField="GRAU_PARENTESCO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;GRAU_PARENTESCO&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteOBSERVACAO" AllowVectorExport="True" Left="215,43321" Top="3,77953" Width="238,11026795" Height="18,89765" StretchMode="smActualHeight" DataField="OBSERVACAO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="0" ParentFont="False" Text="[sqlvisitante.&#34;OBSERVACAO&#34;]"/>
    </TfrxMasterData>
    <TfrxColumnHeader Name="ColumnHeader1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30,23624" Left="0" Top="272,12616" Width="1046,92981">
      <TfrxMemoView Name="Memo4" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo6" AllowVectorExport="True" Left="0" Top="11,33859" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Visitante "/>
      <TfrxMemoView Name="Memo8" AllowVectorExport="True" Left="793,7013" Top="11,33859" Width="75,5906" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Vivência"/>
      <TfrxMemoView Name="Memo10" AllowVectorExport="True" Left="865,51237" Top="11,33859" Width="71,81107" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Motivo"/>
      <TfrxMemoView Name="Memo18" AllowVectorExport="True" Left="590,36258063" Top="7,55906" Width="83,14966" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Interno"/>
      <TfrxMemoView Name="Memo19" AllowVectorExport="True" Left="945,63840063" Top="11,33859" Width="102,04731" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Parentesco"/>
      <TfrxMemoView Name="Memo42" AllowVectorExport="True" Left="525,35467" Top="7,55906" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Protoc."/>
      <TfrxMemoView Name="Memo16" AllowVectorExport="True" Left="445,98454" Top="11,33859" Width="41,57483" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Doc."/>
      <TfrxMemoView Name="Memo7" AllowVectorExport="True" Left="211,65368" Top="7,55906" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="0" ParentFont="False" Text="Menore(s)"/>
    </TfrxColumnHeader>
    <TfrxReportSummary Name="ReportSummary1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Frame.Typ="0" Height="30,23624" Left="0" Top="449,76407" Width="1046,92981">
      <TfrxMemoView Name="Memo9" Align="baClient" AllowVectorExport="True" Left="0" Top="0" Width="1046,92981" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" VAlign="vaBottom" Text="TOTAL DE VISITAS: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" HGuides.Text="" VGuides.Text="" Caption="Listar por Periodo" DoubleBuffered="False" Height="266" ClientHeight="228" Left="493" Top="147" Width="387" Scaled="True" ClientWidth="375" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="92" Top="200" Width="75" Height="25" ShowHint="True" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="208" Top="200" Width="75" Height="25" ShowHint="True" Caption="Cancelar" ModalResult="5"/>
    <TfrxDateEditControl Name="DateEdit1" Left="20" Top="72" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="40934" Time="0,662896504596574" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateEdit2" Left="204" Top="72" Width="145" Height="21" ShowHint="True" Color="-16777211" Date="40934" Time="0,663023900502594" WeekNumbers="False"/>
    <TfrxLabelControl Name="Label2" Left="20" Top="52" Width="72" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Data Inicial" Color="13948117"/>
    <TfrxLabelControl Name="Label3" Left="204" Top="52" Width="63" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Data Final" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
