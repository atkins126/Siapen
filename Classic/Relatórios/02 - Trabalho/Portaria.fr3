<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41892,5167650694" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{ IF ((&#60;GLOBAL_EDUCACAO&#62; &#60;&#62; 'R')) THEN    &#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;      &#13;&#10;&#13;&#10;  end;}  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);  &#13;&#10;begin&#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;SqlListagem.Open;&#13;&#10;SqlDiretor.Open;                                              &#13;&#10;  while not SqlListagem.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlListagem.FieldByName('NOME_INTERNO').AsString +&#13;&#10;   // ' Portaria: '+SqlListagem.FieldByName('DOCUMENTO').AsString +                                                                                                                                       &#13;&#10;    ' ID: '+SqlListagem.FieldByName('id_historico_trabalho').AsString);&#13;&#10;    SqlListagem.Next;&#13;&#10;  END;&#13;&#10; Edit1.Text:=SqlDiretor.FieldByName('nome_funcionario').AsString;&#13;&#10; Edit2.Text:=SqlDiretor.FieldByName('funcao').asString;                                                                                                                         &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                                                                                            &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.    " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3200000020446174615365743D2253716C484953544F5249434F2220446174615365744E616D653D2253716C484953544F5249434F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D2200010C2E00000020446174615365743D2273716C64697265746F722220446174615365744E616D653D2273716C64697265746F72220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C23000000204E616D653D22474C4F42414C5F4A55524944494341222056616C75653D222752272200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C17000000204E616D653D22474C4F42414C5F454455434143414F2200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667402600470546F700228"/>
    <TfrxDBXQuery Name="SqlHISTORICO" UserName="SqlHISTORICO" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.nome_interno, &#13;&#10;i.foto, i.rgi, i.mae, &#13;&#10;i.pai, p.pavilhao, g.galeria,&#13;&#10;c.cela, s.solario, n.nome_up,i.artigo,                         &#13;&#10;t.descricao, t.data, t.data_saida, f.nome_funcionario,t.obs,t.DOCUMENTO,t.id_historico_trabalho, st.setor_trabalho, fi.funcao_interno                                                                                                                                                                             &#13;&#10;from interno i&#13;&#10;   INNER JOIN PAVILHAO p ON (I.idpavilhao = P.id_pavilhao)&#13;&#10;   INNER JOIN GALERIA g ON (I.idgaleria = G.id_galeria)&#13;&#10;   INNER JOIN CELA c ON (I.idcela = C.id_cela)&#13;&#10;   INNER JOIN SOLARIO s ON (I.idsolario = S.id_solario)&#13;&#10;   INNER JOIN unidade_penal n ON (I.id_up = n.id_up)&#13;&#10;   INNER JOIN historico_trabalho t ON (I.id_interno = t.id_interno)&#13;&#10;   INNER JOIN funcionario f ON (I.id_funcionario = f.id_funcionario)&#13;&#10;   INNER JOIN setor_trabalho st ON (i.idsetor_trabalho = st.id_setor_trabalho)&#13;&#10;   INNER JOIN funcao_interno fi ON (t.id_funcao_interno = fi.id_funcao_interno)                                                                                                                                                                                                              &#13;&#10;WHERE I.ST = 'A' AND I.ID_UP = :ID_UP    &#13;&#10;AND (i.nome_interno||' ID: '|| t.id_historico_trabalho = :INTERNO)  &#13;&#10;&#13;&#10;      " Database="database" PropData="05704C65667402600470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D22494E5445524E4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58312E54455854220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email, u.sigla                                                                         &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    i.NOME_INTERNO, ht.documento, ht.id_historico_trabalho                                                                                                                                                                                                                                                                   &#13;&#10;  &#13;&#10;FROM historico_trabalho ht                                                                                  &#13;&#10;Inner Join interno i on (ht.id_interno = i.id_interno)&#13;&#10;WHERE ht.DATA_SAIDA is null and i.st = 'A' and I.ID_UP = :ID_UP                                                                                           &#13;&#10;ORDER BY NOME_INTERNO                                                                       " Database="database" PropData="05704C65667403B8000470546F7002340A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqldiretor" UserName="sqldiretor" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT f.nome_funcionario, f.funcao &#13;&#10;FROM funcionario f &#13;&#10;&#13;&#10;where f.id_up = :ID_UP&#13;&#10;and f.funcao like 'DIRETOR'  " Database="database" PropData="05704C65667403D8000470546F70038C000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="4" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="1046,92981" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="772,91387158" Left="0" ParentFont="False" Top="211,65368" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlHISTORICO" DataSetName="SqlHISTORICO" RowCount="0" Stretched="True">
      <TfrxMemoView Name="SqlhitoricoDATA_SAIDA" Left="15,11812" Top="22,67718" Width="321,26005" Height="18,89765" DataSet="SqlHISTORICO" DataSetName="SqlHISTORICO" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Portaria NÂ°: [SqlHISTORICO.&#34;DOCUMENTO&#34;] - [SqlUp.&#34;Sigla&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="396,85065" Top="79,37013" Width="283,46475" Height="120,94496" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haBlock" ParentFont="False" Text="O Sr. [edit1.text], [edit2.text], da [Sqlup.&#34;NOME_UP&#34;], nos usos de suas atribuiÃ§Ãµes legais"/>
      <TfrxMemoView Name="Memo5" Left="15,11812" Top="264,5671" Width="665,19728" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo8" Left="15,11812" Top="472,44125" Width="665,19728" Height="45,35436" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="PUBLIQUE-SE&#13;&#10;CUMPRA-SE"/>
      <TfrxMemoView Name="Memo9" Left="15,11812" Top="566,9295" Width="665,19728" Height="45,35436" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd ' de '  mmmm ' de ' yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[SqlUP.&#34;Cidade&#34;] - [SqlHistorico.&#34;DATA&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="15,11812" Top="672,75634" Width="665,19728" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[edit1.text]"/>
      <TfrxMemoView Name="Memo11" Left="15,11812" Top="691,65399" Width="665,19728" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[edit2.text]/[SqlUp.&#34;Sigla&#34;]"/>
      <TfrxRichView Name="Rich1" Left="15,11812" Top="226,7718" Width="665,19728" Height="215,43321" GapX="2" GapY="1" PropData="0852696368456469740A940300007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7B5C66315C666E696C204D532053616E732053657269663B7D7D0D0A5C766965776B696E64345C7563315C706172645C66693534305C716A5C6673323220436F6E7369646572616E646F20617320696E666F726D615C2765375C2766356573206F627469646173206A756E746F20616F20436F6E73656C686F204469736369706C696E617220646573746120756E69646164652C20646520717565206F20726565647563616E646F20706F7373756920626F6D20636F6D706F7274616D656E746F20652061707469645C2765336F2070617261206F2074726162616C686F2E5C7061720D0A5C706172645C66693534305C7061720D0A5C706172645C66693534305C7163205265736F6C76653A5C7061720D0A5C7061720D0A5C706172645C66693534305C716A204175746F72697A6172206F20726565647563616E646F2C5C6220205B53514C486973746F7269636F2E226E6F6D655F696E7465726E6F225D5C6230202C5C6220205C623020636F6E64656E61646F2070656C6F732873292061727469676F287329205B53514C486973746F7269636F2E2241727469676F225D2C206120646573656E766F6C766572206120617469766964616465206C61626F7261746976612E205C6220285B53716C486973746F7269636F2E2266756E63616F5F696E7465726E6F225D295C62305C7061720D0A5C706172645C66693534305C7061720D0A5C706172645C66693534305C716A202020202020202020202020202020202020202020412070726573656E746520706F72746172696120706F646520736572207265766F676164612061207175616C71756572206D6F6D656E746F20706F722066616C7461206469736369706C696E61722C20696E65666963695C2765616E636961206F75207175616C71756572206F7574726F206D6F7469766F207175652064657361626F6E65206120636F6E6475746120646F20726565647563616E646F2E5C7061720D0A5C706172645C6669313738305C716A5C7061720D0A5B494946283C53514C486973746F7269636F2E226F6273223E3D27272C274F42533A20272B3C53514C486973746F7269636F2E226F6273223E2C2727295D5C7061720D0A5C706172645C66693534305C716A5C66315C667331365C7061720D0A7D0D0A00"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="132,62214" Left="0" ParentFont="False" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo4" Left="0" Top="7,55906" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="68,03154" Width="718,1107" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture1" Left="608,50433976" Top="23,67718" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="3,77953" Top="23,67717512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxReportTitle>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="280" Left="318" Top="114" Width="483" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="196" Top="208" Width="75" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="284" Top="208" Width="75" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Sair" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxLabelControl Name="CALIBRE" Left="24" Top="13" Width="56" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Interno" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="24" Top="36" Width="421" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    <TfrxLabelControl Name="Label3" Left="24" Top="68" Width="317" Height="13" Font.Charset="1" Font.Color="255" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="* Deixar em branco o campo acima para relacionar todos internos." Color="13948117" OnClick="Label3OnClick"/>
    <TfrxEditControl Name="Edit1" Left="24" Top="116" Width="413" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" Text="Edit1"/>
    <TfrxLabelControl Name="Label1" Left="24" Top="96" Width="49" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Cargo:" Color="14211288"/>
    <TfrxLabelControl Name="Label2" Left="24" Top="144" Width="58" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Função:" Color="14211288"/>
    <TfrxEditControl Name="Edit2" Left="24" Top="168" Width="413" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Color="-16777211" MaxLength="0" PasswordChar="0" Text="Edit1"/>
  </TfrxDialogPage>
</TfrxReport>
