<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41183,5715755556" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  memo5.text := 'Relatório de Visitas - '+ datetostr(dateedit1.date);                                                                  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;    DateEdit1.date := date;                                      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure lbldataOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3A00000020446174615365743D2273716C7669736974616E7465734469612220446174615365744E616D653D2273716C7669736974616E7465734469612200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C2E00000020446174615365743D2273716C64697265746F722220446174615365744E616D653D2273716C64697265746F722200010C2E00000020446174615365743D2273716C6D656E6F7265732220446174615365744E616D653D2273716C6D656E6F726573220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C19000000204E616D653D2249445F5550222056616C75653D223130362200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="Interbase" GetDriverFunc="getSQLDriverINTERBASE" LibraryName="dbexpint.dll" LoginPrompt="False" Params.Text="BlobSize=-1&#13;&#10;CommitRetain=False&#13;&#10;Database=database.gdb&#13;&#10;DriverName=Interbase&#13;&#10;ErrorResourceFile=&#13;&#10;LocaleCode=0000&#13;&#10;Password=masterkey&#13;&#10;RoleName=RoleName&#13;&#10;ServerCharSet=&#13;&#10;SQLDialect=1&#13;&#10;Interbase TransIsolation=ReadCommited&#13;&#10;User_Name=sysdba&#13;&#10;WaitOnLocks=True" VendorLib="fbclient.DLL" PropData="05704C65667403B4000470546F700224"/>
    <TfrxDBXQuery Name="sqlvisitantesDia" UserName="sqlvisitantesDia" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;        iif(mdv.sexo='F','Feminino','Masculino') sexo,&#13;&#10;        G.GALERIA, s.solario, count(*)&#13;&#10;from mov_diario_visitantes mdv&#13;&#10;join visitante_interno vi on (mdv.id_visitante=vi.id_visitante)&#13;&#10;join visitante v on (v.id_visitante=vi.id_visitante)&#13;&#10;join interno i on (vi.id_interno=i.id_interno)&#13;&#10;join pavilhao p on (i.idpavilhao=p.id_pavilhao)&#13;&#10;join galeria g on (i.idgaleria=g.id_galeria)&#13;&#10;join solario s on (i.idsolario=s.id_solario)    &#13;&#10;where mdv.data_visita=:DATA AND I.ID_UP = :ID_UP&#13;&#10;and v.tipo_visitante not like 'Menor'&#13;&#10;and coalesce(mdv.cancelado,'N')&#60;&#62;'S'                                                                          &#13;&#10;group by iif(mdv.sexo='F','Feminino','Masculino'),&#13;&#10;G.GALERIA, s.solario                                   " Database="database" PropData="05704C65667403AC000470546F7002640A506172616D657465727301010C3A000000204E616D653D2244415441222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974312E646174652200010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email,u.sigla                         &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C6566740314010470546F7002240A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqldiretor" UserName="sqldiretor" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT f.nome_funcionario,f.funcao&#13;&#10;&#13;&#10;FROM funcionario  f&#13;&#10;&#13;&#10;where f.id_up = :up and f.funcao like '%DIRETOR%'  " Database="database" PropData="05704C6566740360010470546F7003C4000A506172616D657465727301010C3C000000204E616D653D227570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlmenores" UserName="sqlmenores" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select count(*) as qtdemenor, g.galeria                                                          &#13;&#10;from mov_diario_visitantes mdv&#13;&#10;join visitante_interno vi on (mdv.id_visitante=vi.id_visitante)&#13;&#10;join visitante v on (v.id_visitante=vi.id_visitante)      &#13;&#10;join interno i on (vi.id_interno=i.id_interno)&#13;&#10;join pavilhao p on (i.idpavilhao=p.id_pavilhao)&#13;&#10;join galeria g on (i.idgaleria=g.id_galeria)    &#13;&#10;where mdv.data_visita=:DATA and i.id_up = :id_up and v.tipo_visitante = 'Menor'                                                                                                                               &#13;&#10;group by g.galeria     " Database="database" PropData="05704C6566740388000470546F7003B8000A506172616D657465727301010C3A000000204E616D653D2244415441222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974312E646174652200010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5" RightMargin="5" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="206" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageHeader Name="PageHeader1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="4" Height="143,62214" Left="0" ParentFont="False" Top="18,89765" Width="755,906">
      <TfrxMemoView Name="Memo2" Left="0" Top="3,77953" Width="752,12647" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="79,37013" Width="755,906" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture1" Left="638,74057976" Top="16,11812" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="7,55906" Top="19,89764512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxPageHeader>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="702,99258" Width="755,906">
      <TfrxMemoView Name="Memo19" Left="3,77953" Top="3,77953000000002" Width="752,12647" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time]"/>
    </TfrxPageFooter>
    <TfrxGroupHeader Name="GroupHeader1" Height="30,23624" Left="0" Top="222,99227" Width="755,906" Condition="sqlvisitantesDia.&#34;SEXO&#34;" KeepTogether="True">
      <TfrxMemoView Name="Memo7" Align="baClient" Left="0" Top="0" Width="755,906" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxMemoView Name="sqlvisitantesDiaSEXO" Left="18,89765" Top="7,55906" Width="185,19697" Height="18,89765" DataSet="sqlvisitantesDia" DataSetName="sqlvisitantesDia" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[sqlvisitantesDia.&#34;SEXO&#34;]"/>
    </TfrxGroupHeader>
    <TfrxMasterData Name="MasterData1" Height="22,67718" Left="0" Top="321,26005" Width="755,906" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitantesDia" DataSetName="sqlvisitantesDia" RowCount="0">
      <TfrxMemoView Name="Memo10" Align="baClient" Left="0" Top="0" Width="755,906" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxRichView Name="Rich4" Left="147,40167" Top="3,77953" Width="132,28355" Height="18,89765" GapX="2" GapY="1" PropData="0852696368456469740AB20000007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7D0D0A5C766965776B696E64345C7563315C706172645C66733232205B73716C7669736974616E7465734469612E22736F6C6172696F225D20202020202020202020202020202020202020202020202020202020202020202020205C7061720D0A7D0D0A00"/>
      <TfrxMemoView Name="Memo16" Left="279,68522" Top="3,77953" Width="128,50402" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="[sqlvisitantesDia.&#34;COUNT&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="52,91342" Top="3,77953" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[GLOBAL_NIVEL_3]: "/>
    </TfrxMasterData>
    <TfrxGroupFooter Name="GroupFooter1" Height="34,01577" Left="0" Top="366,61441" Width="755,906">
      <TfrxMemoView Name="Memo11" Align="baClient" Left="0" Top="0" Width="755,906" Height="34,01577" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo1" Left="162,51979" Top="7,55906" Width="532,91373" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="Total Bloco ... [SUM(&#60;sqlvisitantesDia.&#34;COUNT&#34;&#62;,MasterData1)]"/>
    </TfrxGroupFooter>
    <TfrxMasterData Name="MasterData2" Height="22,67718" Left="0" Top="510,23655" Width="755,906" ColumnWidth="0" ColumnGap="0" DataSet="sqlmenores" DataSetName="sqlmenores" RowCount="0">
      <TfrxMemoView Name="Memo18" Align="baClient" Left="0" Top="0" Width="755,906" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxRichView Name="Rich2" Left="268,34663" Top="3,77953" Width="113,3859" Height="18,89765" GapX="2" GapY="1" PropData="0852696368456469740A930000007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7D0D0A5C766965776B696E64345C7563315C706172645C66733232205B73716C6D656E6F7265732E22717464654D454E4F52225D20202020202020205C7061720D0A7D0D0A00"/>
      <TfrxMemoView Name="Memo15" Left="41,57483" Top="3,77953000000002" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[GLOBAL_NIVEL_2]: "/>
      <TfrxRichView Name="Rich3" Left="136,06308" Top="3,77953000000002" Width="132,28355" Height="18,89765" GapX="2" GapY="1" PropData="0852696368456469740AAC0000007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7D0D0A5C766965776B696E64345C7563315C706172645C66733232205B73716C6D656E6F7265732E2267616C65726961225D20202020202020202020202020202020202020202020202020202020202020202020205C7061720D0A7D0D0A00"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="86,92918024" Left="0" Top="593,38621" Width="755,906">
      <TfrxMemoView Name="Memo12" Align="baClient" Left="0" Top="0" Width="755,906" Height="86,92918024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo4" Left="143,62214" Top="7,55906" Width="627,40198" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Total Menores... [SUM(&#60;sqlmenores.&#34;QtdeMENOR&#34;&#62;,MasterData2)]"/>
      <TfrxMemoView Name="Memo9" Left="18,89765" Top="56,69295" Width="538,5827748" Height="22,67717024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="TOTAL GERAL DE VISITANTES : [SUM(&#60;sqlvisitantesDia.&#34;COUNT&#34;&#62; ,masterdata1) + SUM(&#60;sqlmenores.&#34;QtdeMENOR&#34;&#62;,MasterData2) ]"/>
      <TfrxMemoView Name="Memo20" Left="151,1812" Top="34,01577" Width="627,40198" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Total Maiores... [SUM(&#60;sqlvisitantesdia.&#34;count&#34;&#62;,MasterData1)]"/>
    </TfrxReportSummary>
    <TfrxGroupHeader Name="GroupHeader3" Height="22,67718" Left="0" Top="275,90569" Width="755,906" Condition="sqlvisitantesDia.&#34;galeria&#34;">
      <TfrxMemoView Name="Memo13" Align="baClient" Left="0" Top="0" Width="755,906" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxRichView Name="Rich1" Left="132,28355" Top="1" Width="132,28355" Height="18,89765" GapX="2" GapY="1" PropData="0852696368456469740AB20000007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7D0D0A5C766965776B696E64345C7563315C706172645C66733232205B73716C7669736974616E7465734469612E2267616C65726961225D20202020202020202020202020202020202020202020202020202020202020202020205C7061720D0A7D0D0A00"/>
      <TfrxMemoView Name="Memo14" Left="37,7953" Top="1" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="[GLOBAL_NIVEL_2]: "/>
    </TfrxGroupHeader>
    <TfrxHeader Name="Header1" Height="18,89765" Left="0" Top="468,66172" Width="755,906">
      <TfrxMemoView Name="Memo3" Left="22,67718" Top="0" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Menores"/>
      <TfrxMemoView Name="Memo21" Align="baClient" Left="0" Top="0" Width="755,906" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
    </TfrxHeader>
    <TfrxGroupFooter Name="GroupFooter2" Height="22,67718" Left="0" Top="423,30736" Width="755,906">
      <TfrxMemoView Name="Memo23" Align="baClient" Left="0" Top="0" Width="755,906" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo22" Left="162,51979" Top="0" Width="532,91373" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaBottom" Text="Total Sexo ... [SUM(&#60;sqlvisitantesDia.&#34;COUNT&#34;&#62;,MasterData1)]"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="SIAPEN" Height="200" Left="265" Top="150" Width="300" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="OK" Left="92" Top="100" Width="75" Height="25" Caption="OK" Default="True" ModalResult="1"/>
    <TfrxLabelControl Name="lbldata" Left="20" Top="28" Width="31" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Data" Color="13948117" OnClick="lbldataOnClick"/>
    <TfrxDateEditControl Name="DateEdit1" Left="20" Top="48" Width="145" Height="21" Color="-16777211" Date="41082,4819521181" Time="41082,4819521181"/>
  </TfrxDialogPage>
</TfrxReport>
