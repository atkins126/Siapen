<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41740,3906273264" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{ IF ((&#60;GLOBAL_EDUCACAO&#62; &#60;&#62; 'R')) THEN    &#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;      &#13;&#10;&#13;&#10;  end;}  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);  &#13;&#10;begin&#13;&#10;  
Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;  SqlListagem.Open;&#13;&#10;  while not SqlListagem.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlListagem.FieldByName('NOME_INTERNO').AsString);&#13;&#10;    SqlListagem.Next;    &#13;&#10;  &#13;&#10;  END;&#13;&#10;&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if ComboBox1.itemindex = -1 then&#13;&#10;    ComboBox1.Text := '-1';                                    &#13;&#10;&#13;&#10;  SqlListagem.First;&#13;&#10;  while not SqlListagem.EOF do&#13;&#10;  begin&#13;&#10;    if ComboBox1.itemindex = SqlListagem.recno then&#13;&#10;    begin                &#13;&#10;      ComboBox1.text := SqlListagem.FieldByName('ID_INTERNO').AsString;&#13;&#10;      break;                    &#13;&#10;    end;                      &#13;&#10;    SqlListagem.Next;    &#13;&#10;                    &#13;&#10;  end;&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Edit1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Memo27OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.    " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D2200010C2E00000020446174615365743D2253716C4368616D6164612220446174615365744E616D653D2253716C4368616D616461220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667402600470546F700224"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT ID_INTERNO,                              &#13;&#10;      NOME_INTERNO                                                                                                            &#13;&#10;FROM INTERNO&#13;&#10;WHERE ST = 'A' &#13;&#10;AND ID_UP = :ID_UP&#13;&#10;AND COALESCE (interno.IDSERIEESTUDO, '') &#60;&#62; ''    &#13;&#10;ORDER BY NOME_INTERNO                                                            &#13;&#10;                                                                       " Database="database" PropData="05704C65667403BC000470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlChamada" UserName="SqlChamada" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10; iif (trim(coalesce(c.cidade, ''))='','Não Informado',c.cidade) as naturalidade,&#13;&#10; iif (trim(coalesce(c.uf, ''))='','',c.uf) as uf,                                                                                                                                                                                        &#13;&#10; i.nome_interno,&#13;&#10; i.turma,&#13;&#10; i.periodo,&#13;&#10; t.serie_estudo,&#13;&#10; i.mae,&#13;&#10; i.pai,&#13;&#10; i.rgi,&#13;&#10; i.data_matricula,&#13;&#10; i.data_nascimento,&#13;&#10;-- c.cidade,&#13;&#10; e.escolaridade&#13;&#10;&#13;&#10;from interno i&#13;&#10;&#13;&#10;left join serie_estudo t on t.id_serie_estudo = i.idserieestudo&#13;&#10;left join escolaridade e on e.id_escolaridade = i.idescolaridade&#13;&#10;left join cidade c on c.id_cidade = i.idnaturalidade&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;WHERE I.ST = 'A' &#13;&#10;AND I.ID_UP = :ID_UP&#13;&#10;AND COALESCE (I.IDSERIEESTUDO, '') &#60;&#62; ''                                                                                                                                                                                                                                                      &#13;&#10;AND ((I.ID_INTERNO = :INTERNO) OR (:INTERNO = -1))                                                                                                         &#13;&#10;&#13;&#10;ORDER BY I.NOME_INTERNO                    &#13;&#10;                                           " Database="database" PropData="05704C65667403B0000470546F7003B4000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D22494E5445524E4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78312E746578742200010C3F000000204E616D653D22494E5445524E4F222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F626F78312E74657874220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="217" Left="330" Top="142" Width="461" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="24" Top="101" Width="75" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="185" Top="101" Width="75" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Sair" ModalResult="2"/>
    <TfrxLabelControl Name="CALIBRE" Left="18" Top="9" Width="56" Height="18" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Interno" Color="14211288" OnClick="CALIBREOnClick"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="18" Top="36" Width="413" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
    <TfrxLabelControl Name="Label1" Left="20" Top="56" Width="392" Height="13" Font.Charset="1" Font.Color="16711680" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="* Deixar em branco para listar todos internos matrículados no período selecionado" Color="13948117"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="4" PaperWidth="210" PaperHeight="190" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="7,55906" Left="0" Top="600,94527" Width="718,1107"/>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="411,96877" Left="0" ParentFont="False" Top="128,50402" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlChamada" DataSetName="SqlChamada" RowCount="0" StartNewPage="True" Stretched="True">
      <TfrxMemoView Name="Memo3" Left="15,11812" Top="3,77953" Width="668,97681" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="0" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" LineSpacing="2,5" ParentFont="False" Text="NOME: [SqlChamada.&#34;NOME_INTERNO&#34;] "/>
      <TfrxMemoView Name="Memo4" Left="15,11812" Top="49,13389" Width="668,97681" Height="41,57483" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-24" Font.Name="Calibri" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="FILIAÃÃO"/>
      <TfrxMemoView Name="Memo13" Left="11,33859" Top="109,60637" Width="672,75634" Height="56,69295" DisplayFormat.DecimalSeparator="," Font.Charset="0" Font.Color="-16777208" Font.Height="-19" Font.Name="Calibri" Font.Style="0" ParentFont="False" Text="MÃE: [SqlChamada.&#34;Mae&#34;]&#13;&#10;PAI: [SqlChamada.&#34;Pai&#34;] "/>
      <TfrxMemoView Name="Memo14" Left="15,11812" Top="185,19697" Width="668,97681" Height="56,69295" DisplayFormat.DecimalSeparator="," Font.Charset="0" Font.Color="-16777208" Font.Height="-19" Font.Name="Calibri" Font.Style="0" ParentFont="False" Text="DATA DE NASCIMENTO: [SqlChamada.&#34;DATA_NASCIMENTO&#34;] LOCAL DE NASCIMENTO : [SQLChamada.&#34;NATURALIDADE&#34;] - [SQLChamada.&#34;UF&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="15,11812" Top="253,22851" Width="668,97681" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-24" Font.Name="Calibri" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="MATRICULAR NA:"/>
      <TfrxRichView Name="Rich1" Left="15,11812" Top="302,3624" Width="668,97681" Height="109,60637" GapX="2" GapY="1" PropData="0852696368456469740AC90100007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C6663686172736574302043616C696272693B7D7B5C66315C666E696C204D532053616E732053657269663B7D7D0D0A5C766965776B696E64345C7563315C706172645C66305C667332345C7061720D0A282020202920315C2762612053454720315C2762612046415345205C74616220202020282020202920325C2762612053454720315C276261204641534520202020205C7461622020282020202920454E53494E4F204D5C27633944494F20315C2762612046415345204D415420205C7061720D0A282020202920315C2762612053454720325C2762612046415345205C74616220202020282020202920325C2762612053454720325C27626120464153452020202020202020202020202020202020202820202029454E53494E4F204D5C27633944494F204D554C5449454A41204D415420205C7061720D0A282020202920315C2762612053454720335C27626120464153455C74616220202020282020202920325C2762612053454720335C27626120464153452020205C66315C667331365C7061720D0A7D0D0A00"/>
    </TfrxMasterData>
    <TfrxColumnHeader Name="ColumnHeader1" Height="49,13389" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="279,78757" Top="25,89765" Width="177,63791" Height="18,89765" Color="-16777216" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="FICHA DE MATRÃCULA"/>
    </TfrxColumnHeader>
  </TfrxReportPage>
</TfrxReport>
