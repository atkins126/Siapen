<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="42397,6481238542" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{ IF ((&#60;GLOBAL_EDUCACAO&#62; &#60;&#62; 'R')) THEN    &#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;      &#13;&#10;&#13;&#10;  end;}&#13;&#10;    Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');      &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;procedure Label3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;    &#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;end.&#13;&#10;&#13;&#10;  " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D2200010C2E00000020446174615365743D2253716C4368616D6164612220446174615365744E616D653D2253716C4368616D6164612200010C2C00000020446174615365743D2253716C45737475646F2220446174615365744E616D653D2253716C45737475646F2200010C2E00000020446174615365743D2253716C506572696F646F2220446174615365744E616D653D2253716C506572696F646F2200010C2A00000020446174615365743D2253716C426C6F636F2220446174615365744E616D653D2253716C426C6F636F2200010C2600000020446174615365743D2253716C416C612220446174615365744E616D653D2253716C416C61220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.dll" PropData="05704C65667402300470546F700220"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402700470546F7002200A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     TURMA                                                                           &#13;&#10;FROM INTERNO                                                                     &#13;&#10;WHERE   coalesce(TURMA, '') &#60;&#62; ''                                                      &#13;&#10;  &#13;&#10;ORDER BY TURMA&#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;    " Database="database" PropData="05704C65667402300470546F7002540A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlChamada" UserName="SqlChamada" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.nome_interno,i.periodo, i.turma, i.foto, i.rgi, i.data_matricula, p.pavilhao, g.galeria,&#13;&#10;c.cela, s.solario, u.id_up, u.nome_up, se.serie_estudo, i.cpf, i.rg, i.ORGAO_EMISSOR_RG, t.documento                                                                                                                                      &#13;&#10;from interno i&#13;&#10;   INNER JOIN PAVILHAO p ON (I.idpavilhao = P.id_pavilhao)&#13;&#10;   INNER JOIN GALERIA g ON (I.idgaleria = G.id_galeria)&#13;&#10;   INNER JOIN CELA c ON (I.idcela = C.id_cela)&#13;&#10;   INNER JOIN SOLARIO s ON (I.idsolario = S.id_solario)&#13;&#10;   INNER JOIN unidade_penal u ON (I.id_up = u.id_up)&#13;&#10;   INNER JOIN serie_estudo se ON (I.idserieestudo = se.id_serie_estudo)&#13;&#10;   LEFT JOIN historico_trabalho t ON (I.id_interno = t.id_interno)     &#13;&#10;   LEFT JOIN setor_trabalho st ON (i.idsetor_trabalho = st.id_setor_trabalho)&#13;&#10;   LEFT JOIN funcao_interno fi ON (t.id_funcao_interno = fi.id_funcao_interno)       &#13;&#10;&#13;&#10;WHERE I.ST = 'A' AND I.ID_UP = :ID_UP&#13;&#10;AND st.setor_trabalho = 'EDUCACAO' AND t.data_saida is null                                                                                                                              &#13;&#10;                                                                                     &#13;&#10;ORDER BY I.nome_interno                                                 &#13;&#10;                                           " Database="database" PropData="05704C65667402700470546F7002540A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlEstudo" UserName="SqlEstudo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     ID_SERIE_ESTUDO, SERIE_ESTUDO                                                                                                               &#13;&#10;FROM SERIE_ESTUDO     &#13;&#10;    &#13;&#10;WHERE   coalesce(SERIE_ESTUDO, '') &#60;&#62; ''&#13;&#10;&#13;&#10;    &#13;&#10;ORDER BY  SERIE_ESTUDO&#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;              " Database="database" PropData="05704C65667402500470546F7003A4000A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlPeriodo" UserName="SqlPeriodo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT DISTINCT&#13;&#10;     PERIODO                                                                                       &#13;&#10;FROM INTERNO                                                                     &#13;&#10;WHERE   coalesce(PERIODO, '') &#60;&#62; ''                                                                                &#13;&#10;  &#13;&#10;ORDER BY PERIODO            &#13;&#10;&#13;&#10;                                                                 &#13;&#10;&#13;&#10;    " Database="database" PropData="05704C65667403C8000470546F7002200A506172616D65746572730100"/>
    <TfrxDBXQuery Name="SqlBloco" UserName="SqlBloco" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select g.galeria from galeria g&#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)&#13;&#10;where p.id_up = :id_up&#13;&#10;order by g.galeria    " Database="database" PropData="05704C65667403C8000470546F7002600A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlAla" UserName="SqlAla" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select s.solario from solario s&#13;&#10;inner join galeria g on (g.id_galeria = s.idgaleria)    &#13;&#10;inner join pavilhao p on (p.id_pavilhao=g.idpavilhao)                                                                                                                   &#13;&#10;where p.id_up = :id_up and g.galeria = :GALERIA                                                            &#13;&#10;order by s.solario                         " Database="database" PropData="05704C65667403AC000470546F7003B4000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D2247414C45524941222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F426F78322E74657874220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="4" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="5" TopMargin="10" BottomMargin="10" Columns="2" ColumnWidth="97,5" ColumnPositions.Text="0&#13;&#10;97,5" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="184" Width="737,00835">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="15,11812" Left="0" ParentFont="False" Top="96" Width="368,504175" ColumnWidth="0" ColumnGap="0" DataSet="SqlChamada" DataSetName="SqlChamada" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo5" Left="1,96062667" Top="0" Width="21,41733667" Height="15,11811024" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[line]"/>
      <TfrxMemoView Name="SqlChamadaNOME_INTERNO" Left="25,89765" Top="0" Width="343,93723" Height="15,11812" StretchMode="smMaxHeight" DataSet="SqlChamada" DataSetName="SqlChamada" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[SqlChamada.&#34;NOME_INTERNO&#34;] - [SqlChamada.&#34;DOCUMENTO&#34;]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="30,23624" Left="0" Top="132" Width="737,00835">
      <TfrxMemoView Name="Memo9" Left="12,55905512" Top="3,77953000000002" Width="198,4250748" Height="18,89764024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="12" ParentFont="False" Text="Total de Alunos: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
    <TfrxPageHeader Name="PageHeader1" Height="60,47248" Left="0" Top="16" Width="737,00835">
      <TfrxMemoView Name="Memo3" Left="-7,55906" Top="10,11812" Width="737,00835" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="7" HAlign="haCenter" ParentFont="False" Text="Lista Alunos com ou sem portaria"/>
    </TfrxPageHeader>
  </TfrxReportPage>
</TfrxReport>
