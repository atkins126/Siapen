<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="45051,4327786921" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{ IF ((&#60;GLOBAL_EDUCACAO&#62; &#60;&#62; 'R')) THEN    &#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;      &#13;&#10;&#13;&#10;  end;}  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);  &#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');&#13;&#10;  DateEdit1.Date := Date-15;&#13;&#10;  DateEdit2.Date := Date;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.    " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2C00000020446174615365743D2253716C45737475646F2220446174615365744E616D653D2253716C45737475646F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C23000000204E616D653D22474C4F42414C5F4A55524944494341222056616C75653D222752272200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C17000000204E616D653D22474C4F42414C5F454455434143414F2200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667402600470546F700228"/>
    <TfrxDBXQuery Name="SqlEstudo" UserName="SqlEstudo" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT (SELECT t.NOMELIMPO&#13;&#10;FROM LIMPAR ((SELECT p.NOMELIMPO&#13;&#10;FROM SEM_FUGA (i.nome_interno) p)) t) as nome,i.rg,i.pai, i.mae, i.cpf, up.nome_up, d.destino, ti.data, i.rgi, p.pavilhao, g.galeria,&#13;&#10;c.cela, s.solario, e.serie_estudo, up.nome_up, i.RGI,&#13;&#10;i.orgao_emissor_rg as orgao_expedidor, he.DATA_MATRICULA                                                                &#13;&#10;&#13;&#10;FROM transferencia_interno ti&#13;&#10;  &#13;&#10;INNER JOIN vinc_transferencia_interno vti ON (vti.id_transferencia_interno = ti.id_transferencia_interno)&#13;&#10;LEFT JOIN unidade_penal up ON (up.id_up = ti.id_up_destino)&#13;&#10;LEFT JOIN destino d ON (d.id_destino = ti.id_destino)&#13;&#10;INNER JOIN interno i ON (i.id_interno = vti.id_interno)&#13;&#10;INNER JOIN pavilhao p ON (i.idpavilhao = p.id_pavilhao)&#13;&#10;INNER JOIN galeria g ON (i.idgaleria = g.id_galeria)&#13;&#10;INNER JOIN cela c ON (i.idcela = c.id_cela)&#13;&#10;INNER JOIN solario s ON(i.idsolario = s.id_solario)&#13;&#10;inner join historico_estudo he on (he.ID_HISTORICO_ESTUDO = (Select max(he1.id_historico_estudo) as historico &#13;&#10; from historico_estudo he1&#13;&#10; where he1.id_interno = i.id_interno&#13;&#10; and he1.id_serie_estudo is not null&#13;&#10;) ) &#13;&#10;left join serie_estudo e on (e.ID_SERIE_ESTUDO = he.ID_SERIE_ESTUDO)&#13;&#10;&#13;&#10;  &#13;&#10;WHERE ti.liberada = 'S'&#13;&#10;AND ti.recebida = 'S'&#13;&#10;AND ti.id_origem = :id_up                                 &#13;&#10;AND COALESCE(e.id_serie_estudo, '') &#60;&#62; ''                                                                                                                      &#13;&#10;AND ti.data between :data and :datafinal&#13;&#10;AND e.serie_estudo not like 'Z - CANCELADA%'                                                                                                                                         &#13;&#10;                                                                                                                                                                &#13;&#10;  &#13;&#10;ORDER BY ti.data, i.nome_interno&#13;&#10;  &#13;&#10;&#13;&#10;      " Database="database" PropData="05704C65667402600470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3A000000204E616D653D2264617461222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974312E646174652200010C3F000000204E616D653D226461746166696E616C222044617461547970653D22667444617465222045787072657373696F6E3D224461746545646974322E64617465220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT &#13;&#10;    SERIE_ESTUDO                                                                  &#13;&#10;  &#13;&#10;FROM SERIE_ESTUDO                          &#13;&#10;&#13;&#10;  &#13;&#10;ORDER BY SERIE_ESTUDO                        " Database="database" PropData="05704C65667403C4000470546F70025C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="476" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="710,55164" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData2" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="257,00802535" Left="0" ParentFont="False" Top="200" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlEstudo" DataSetName="SqlEstudo" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo7" Left="340,14193" Top="7,55906" Width="336,37810654" Height="22,67716535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="DATA DE SAIDA: [SqlEstudo.&#34;DATA&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="8,37787953" Top="7,55906" Width="332,59849843" Height="45,35434535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="13" ParentFont="False" Text="[SqlEstudo.&#34;NOME&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="340,15748031" Top="94,48825" Width="336,37817" Height="49,13387535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="2" ParentFont="False" Text="DESTINO: [SqlEstudo.&#34;NOME_UP&#34;][SqlEstudo.&#34;DESTINO&#34;]"/>
      <TfrxMemoView Name="Memo16" Left="340,1577" Top="173,85838" Width="298,58287" Height="22,67716535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="TURMA: [SqlEstudo.&#34;SERIE_ESTUDO&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="7,55906" Top="94,48825" Width="219,21274" Height="49,13387535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="RG: [SqlEstudo.&#34;RG&#34;] - [SqlEstudo.&#34;ORGAO_EXPEDIDOR&#34;]&#13;&#10;CPF: [SqlEstudo.&#34;CPF&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="7,55906" Top="173,85838" Width="219,21274" Height="49,13387535" StretchMode="smMaxHeight" DataSetName="SqlConfere" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="PAI: [SqlEstudo.&#34;PAI&#34;] - MAE: [SqlEstudo.&#34;MAE&#34;]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="162,51979" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo2" Left="7,55906" Top="2,77953488" Width="702,99258" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="3,77953" Top="116,16543488" Width="706,77211" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture4" Left="7,55906" Top="3,77953" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
      <TfrxPictureView Name="Picture1" Left="600,94527976" Top="3,77953488" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
    </TfrxPageHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="262" Left="318" Top="114" Width="483" OnShow="DialogPage1OnShow">
    <TfrxDateEditControl Name="DateEdit1" Left="28" Top="44" Width="145" Height="21" Color="-16777211" Date="40934,6628965046" Time="40934,6628965046"/>
    <TfrxDateEditControl Name="DateEdit2" Left="212" Top="44" Width="145" Height="21" Color="-16777211" Date="40934,6630239005" Time="40934,6630239005"/>
    <TfrxButtonControl Name="Button1" Left="20" Top="112" Width="75" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="OK" ModalResult="1"/>
    <TfrxButtonControl Name="Button2" Left="108" Top="112" Width="75" Height="25" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Sair" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="28" Top="24" Width="72" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Data Inicial" Color="13948117"/>
    <TfrxLabelControl Name="Label2" Left="212" Top="24" Width="63" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Data Final" Color="13948117"/>
  </TfrxDialogPage>
</TfrxReport>
