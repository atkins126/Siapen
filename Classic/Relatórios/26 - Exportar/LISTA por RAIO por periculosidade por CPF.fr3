<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="43809,5098695023" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
&#13;&#10;function StringReplace(before:String;Old:string;New:string):string;&#13;&#10;var&#13;&#10;temporal:string;&#13;&#10;begin&#13;&#10;       temporal := before;&#13;&#10;       DeleteStr(temporal,Pos(Old,Before),length(Old));&#13;&#10;       Insert(temporal,New,Pos(Old,Before));&#13;&#10;       result := temporal;&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var i:integer;&#13;&#10;begin&#13;&#10;   if Memo40.Lines.Count&#62;0 then&#13;&#10;       begin               &#13;&#10;               SqlExportar.Sql.Add(' WHERE i.cpf in(');&#13;&#10;               for i:=0 to Memo40.Lines.Count-1 do&#13;&#10;               begin                                &#13;&#10;                       //parametro:=parametro+''''+memo40.Lines[i]+'''';                 &#13;&#10;                       SqlExportar.Sql.Add(''''+UpperCase(memo40.Lines[i])+'''');                                                          &#13;&#10;                       //if i&#60;Memo40.Lines.Count-1 then parametro:=parametro+',';&#13;&#10;                       if i&#60;Memo40.Lines.Count-1 then SqlExportar.Sql.Add(',');                                                                                                                 &#13;&#10;               end;                                &#13;&#10;       SqlExportar.SQL.Add(') order by i.nome_interno');&#13;&#10;       end;             &#13;&#10;   Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exename)+'..\config\dbxconnections.ini');  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  { IF &#60;GLOBAL_CONFERE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end; }    &#13;&#10;end;   &#13;&#10;&#13;&#10;procedure Memo40OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo40OnChange(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;i: integer;                         &#13;&#10;begin&#13;&#10;  Memo40.Lines.Text := StringReplace(Memo40.Lines.Text,'.','');&#13;&#10;  Memo40.Lines.Text := StringReplace(Memo40.Lines.Text,'-','');&#13;&#10;  for i:=Memo40.Lines.Count-1 downto 0 do begin&#13;&#10;              if Trim(Memo40.Lines[i]) = '' then&#13;&#10;                 Memo40.Lines.Delete(i);&#13;&#10;  end;      &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4578706F727461722220446174615365744E616D653D2253716C4578706F72746172220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C16000000204E616D653D22474C4F42414C5F434F4E464552452200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403B4000470546F700240"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlExportar" UserName="SqlExportar" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.nome_interno as nome,i.rgi as matricula, i.GRAU_PERICULOSIDADE as grau_periculosidade, g.galeria as raio, s.solario as ala, case i.st when 'A' then 'Sim' when 'I' then 'Não' end as ativo                                                                                                                                                                                                                                                                                                               &#13;&#10;from interno i  &#13;&#10;   INNER JOIN PAVILHAO p ON (I.idpavilhao = P.id_pavilhao)&#13;&#10;   INNER JOIN GALERIA g ON (I.idgaleria = G.id_galeria)&#13;&#10;   INNER JOIN CELA c ON (I.idcela = C.id_cela)&#13;&#10;   INNER JOIN SOLARIO s ON (I.idsolario = S.id_solario)&#13;&#10;&#13;&#10;      &#13;&#10;&#13;&#10;      " Database="database" PropData="05704C65667402680470546F7003C8000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="350" PaperHeight="210" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="18,89764024" Left="0" ParentFont="False" Top="98,26778" Width="1247,2449" ColumnWidth="0" ColumnGap="0" DataSet="SqlExportar" DataSetName="SqlExportar" RowCount="0">
      <TfrxMemoView Name="SqlConfereNOME_INTERNO" Left="26,45671" Top="0" Width="340,15739488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;NOME&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="472,44125" Top="0" Width="162,51948488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;Raio&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="634,96104" Top="0" Width="196,53525488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;Ala&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="831,4966" Top="0" Width="147,40136488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;Ativo&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="366,61441" Top="0" Width="105,82653488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;Matricula&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="26,45640488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Line]"/>
      <TfrxMemoView Name="Memo13" Left="978,89827" Top="0" Width="268,34632488" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;grau_periculosidade&#34;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="18,89765" Left="0" Top="18,89765" Width="1247,2449">
      <TfrxMemoView Name="Memo5" Left="26,45671" Top="0" Width="340,1577" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NOME"/>
      <TfrxMemoView Name="Memo1" Left="472,44125" Top="0" Width="162,51979" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Raio"/>
      <TfrxMemoView Name="Memo3" Left="634,96104" Top="0" Width="196,53556" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Ala"/>
      <TfrxMemoView Name="Memo6" Left="831,4966" Top="0" Width="147,40167" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Ativo"/>
      <TfrxMemoView Name="Memo8" Left="366,61441" Top="0" Width="105,82684" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Matricula"/>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="26,45671" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NÂº"/>
      <TfrxMemoView Name="Memo12" Left="978,89827" Top="0" Width="268,34663" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Periculosidade"/>
    </TfrxReportTitle>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="300" Left="265" Top="150" Width="532">
    <TfrxMemoControl Name="Memo40" Left="44" Top="24" Width="413" Height="181" Color="-16777211" Lines.Text="" MaxLength="0" OnChange="Memo40OnChange" OnClick="Memo40OnClick"/>
    <TfrxButtonControl Name="Button1" Left="128" Top="220" Width="75" Height="25" Caption="OK" ModalResult="1"/>
    <TfrxButtonControl Name="Button2" Left="240" Top="220" Width="75" Height="25" Caption="Cancelar" ModalResult="2"/>
  </TfrxDialogPage>
</TfrxReport>
