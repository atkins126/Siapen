<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41145,4560960069" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;&#13;&#10;   SqlSolario.Open;&#13;&#10;  while not SqlSolario.EOF do&#13;&#10;  begin&#13;&#10;    ComboBox1.Items.Add(SqlSolario.FieldByName('SOLARIO').AsString);&#13;&#10;    SqlSolario.Next;&#13;&#10;          &#13;&#10;  end;&#13;&#10;&#13;&#10; ComboBox1.setfocus;     &#13;&#10;&#13;&#10;         &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DBLookupComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;  &#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2E00000020446174615365743D2273716C536F6C6172696F2220446174615365744E616D653D2273716C536F6C6172696F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C2A00000020446174615365743D2253716C4461646F732220446174615365744E616D653D2253716C4461646F73220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C24000000204E616D653D22474C4F42414C5F5649534954414E5445222056616C75653D222752272200010C19000000204E616D653D2249445F5550222056616C75653D223330382200010C34000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D22274D494E495354C952494F204441204A55535449C741272200010C49000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227444550415254414D454E544F2050454E4954454E4349C152494F204E4143494F4E414C272200010C4B000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D222744495245544F52494120444F2053495354454D412050454E4954454E4349C152494F20444F20444627220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlSolario" UserName="sqlSolario" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select DISTINCT &#13;&#10;s.solario&#13;&#10;  &#13;&#10;from galeria g&#13;&#10;     inner join solario s on (g.id_galeria = s.idgaleria)&#13;&#10;     order by s.solario" Database="Database" PropData="05704C65667402480470546F7002680A506172616D65746572730100"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C6566740390000470546F70022C0A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBConnection" DriverName="Interbase" GetDriverFunc="getSQLDriverINTERBASE" LibraryName="dbexpint.dll" LoginPrompt="False" Params.Text="" VendorLib="gds32.dll" PropData="05704C65667402480470546F70022C"/>
    <TfrxDBXQuery Name="SqlDados" UserName="SqlDados" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select  DISTINCT i.nome_interno, i.data_entrada, c.cela, g.galeria, s.solario, p.pavilhao, i.rgi,&#13;&#10;IIF(s.solario = 'ALA D', 'CASTIGO', IIF(s.solario = 'ALA E', 'ESPECIAL', '')) AS OBS, c.motivo_manutencao&#13;&#10;      &#13;&#10;FROM cela c&#13;&#10;       inner join solario s on (c.idsolario = s.id_solario)&#13;&#10;       inner join GALERIA G on (c.idGALERIA = G.id_GALERIA)           &#13;&#10;       inner join pavilhao p on (c.idpavilhao = p.id_pavilhao)         &#13;&#10;       inner join unidade_penal up on (p.id_up = up.id_up)&#13;&#10;       left join interno i on (i.idcela = c.id_cela AND i.st = 'A')&#13;&#10;&#13;&#10;WHERE (p.id_up = :id_up&#13;&#10;AND COALESCE(s.solario, '') &#60;&#62; 'VIRTUAL'&#13;&#10;AND s.solario LIKE '%' || :ALA || '%'&#13;&#10;AND coalesce(i.nome_interno,'')&#60;&#62;'')&#13;&#10;OR (c.em_manutencao = 'S')&#13;&#10;&#13;&#10;ORDER BY s.solario, c.cela    " Database="Database" PropData="05704C6566740390000470546F7002680A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3B000000204E616D653D22414C41222044617461547970653D226674537472696E67222045787072657373696F6E3D22434F4D424F424F58312E54455854220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" Frame.Color="16777215" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="362,83488" Width="1046,92981">
      <TfrxMemoView Name="Memo46" Align="baClient" Left="0" Top="0" Width="1046,92981" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Height="23,67718" Left="0" Top="279,68522" Width="1046,92981" ColumnWidth="0" ColumnGap="0" DataSet="SqlDados" DataSetName="SqlDados" RowCount="0">
      <TfrxMemoView Name="Memo5" Align="baClient" Left="0" Top="0" Width="1046,92981" Height="23,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text=""/>
      <TfrxMemoView Name="sqlvisitanteVISITANTE" Left="36,66141732" Top="2,77953" Width="64,25201" Height="18,89765" StretchMode="smActualHeight" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[SqlDados.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteNOME_INTERNO" Left="573,73227858" Top="2,77953" Width="105,82684" Height="18,89765" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="mm.dd.yyyy" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[SqlDados.&#34;data_entrada&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="504,94488189" Top="2,77953" Width="64,2519685" Height="18,89765" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[SqlDados.&#34;cela&#34;]"/>
      <TfrxMemoView Name="Memo23" Left="0" Top="2,77953" Width="34,01577" Height="18,89765" StretchMode="smActualHeight" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[LINE]"/>
      <TfrxMemoView Name="Memo2" Left="106,96062748" Top="2,77953" Width="298,58287" Height="18,89765" StretchMode="smActualHeight" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" WordWrap="False" VAlign="vaBottom" Text="[SqlDados.&#34;nome_interno&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="409,7007874" Top="2,77953" Width="90,70872" Height="18,89765" StretchMode="smActualHeight" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="[SqlDados.&#34;solario&#34;]"/>
      <TfrxMemoView Name="SqlCamaSTATUS" Left="684,18151" Top="2,77953" Width="68,03149606" Height="18,89765" DataSetName="SqlCama" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="Ocupada"/>
      <TfrxMemoView Name="Memo4" Left="755,906" Top="2,64566929" Width="291,02381" Height="18,89765" StretchMode="smActualHeight" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" WordWrap="False" VAlign="vaBottom" Text="[SqlDados.&#34;MOTIVO_MANUTENCAO&#34;] [SqlDados.&#34;OBS&#34;]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="139,84261" Left="0" Top="18,89765" Width="1046,92981">
      <TfrxMemoView Name="Memo3" Left="0" Top="116,06308" Width="1046,92981" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Arial" Font.Style="1" Frame.Typ="12" HAlign="haCenter" ParentFont="False" Text="RELATÃRIO DE CAMA - ALA"/>
      <TfrxMemoView Name="Memo12" Left="7,55906" Top="69,25201" Width="1028,03216" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture3" Left="924,63049976" Top="8,89765" Width="109,60629921" Height="102,04724165" FileLink="..\logo\direita.jpg"/>
      <TfrxMemoView Name="Memo10" Left="14,55906" Top="3,77953" Width="1020,4731" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture4" Left="12,33859" Top="5,89764512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxPageHeader>
    <TfrxColumnHeader Name="ColumnHeader1" Height="35,76376" Left="0" Top="181,41744" Width="1046,92981">
      <TfrxShapeView Name="Shape2" Left="-0,00773" Top="31,98423" Width="1046,92981" Height="3,77953" Color="0"/>
      <TfrxMemoView Name="Memo18" Left="36,65355063" Top="11,33859" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" Text="ProtuÃ¡rio"/>
      <TfrxMemoView Name="Memo6" Left="106,82684" Top="11,33859" Width="298,582677165354" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" Text="Nome do Interno"/>
      <TfrxMemoView Name="Memo19" Left="409,55133" Top="11,33859" Width="90,70866142" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ala"/>
      <TfrxMemoView Name="Memo24" Left="505,10266" Top="11,33859" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="NÂº Cama"/>
      <TfrxMemoView Name="Memo26" Left="684,19728" Top="11,55906" Width="68,03154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Status"/>
      <TfrxMemoView Name="Memo27" Left="756,02412" Top="11,55906" Width="291,02381" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" ParentFont="False" VAlign="vaCenter" Text="ObservaÃ§Ãµes"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="11,33859" Width="34,01577" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="#"/>
      <TfrxMemoView Name="Memo25" Left="573,69326" Top="0,22047" Width="105,82684" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Entrada na Unidade"/>
    </TfrxColumnHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Informe os Dados" Height="131" Left="265" Top="150" Width="335" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="229" Top="61" Width="83" Height="25" Caption="OK" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxLabelControl Name="Label1" Left="12" Top="8" Width="103" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Bloco - Ala" Color="15854311"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="12" Top="34" Width="301" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
