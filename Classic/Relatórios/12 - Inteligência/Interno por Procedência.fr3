<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="44047,3704842361" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;       &#13;&#10;end;&#13;&#10;&#13;&#10;procedure txtEnderecoOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;SqlListagem.open;&#13;&#10;while not SqlListagem.EOF do&#13;&#10;begin&#13;&#10;       ComboProcedencia.Items.Add(SqlListagem.FieldByName('PROEDENCIA').AsString);&#13;&#10;       SqlListagem.Next;                                           &#13;&#10;end              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end.    &#13;&#10;&#13;&#10;            " OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3000000020446174615365743D2253716C656E64657265636F2220446174615365744E616D653D2253716C656E64657265636F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4C6973746167656D2220446174615365744E616D653D2253716C4C6973746167656D220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C23000000204E616D653D22474C4F42414C5F4A55524944494341222056616C75653D222752272200010C19000000204E616D653D22474C4F42414C5F4449534349504C494E412200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C6501010CA6000000204E616D653D22546578746F20636F6D20706F6E746F2220436F6C6F723D223533363837303931312220466F6E742E436861727365743D22312220466F6E742E436F6C6F723D222D31363737373230382220466F6E742E4865696768743D222D31332220466F6E742E4E616D653D22417269616C2220466F6E742E5374796C653D223022204672616D652E5374796C653D226673446F7422204672616D652E5479703D2238220000">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="[SISAP]&#13;&#10;#Não alterar&#13;&#10;DriverName=DevartInterBase&#13;&#10;RoleName=&#13;&#10;SQLDialect=3&#13;&#10;BlobSize=-1&#13;&#10;ErrorResourceFile=&#13;&#10;LocaleCode=0000&#13;&#10;DevartInterBase TransIsolation=ReadCommited&#13;&#10;WaitOnLocks=False&#13;&#10;Charset=&#13;&#10;CharLength=1&#13;&#10;EnableBCD=True&#13;&#10;OptimizedNumerics=True&#13;&#10;LongStrings=True&#13;&#10;UseQuoteChar=False&#13;&#10;FetchAll=False&#13;&#10;Database=172.18.15.251:siapen&#13;&#10;User_Name=SYSDBA&#13;&#10;Password=masterkey&#13;&#10;LOCAL=DEPEN&#13;&#10;NOME=SISTEMA PENITENCIÁRIO DO ESTADO DE MATO GROSSO&#13;&#10;ORGAO=GOVERNO DO ESTADO DE MATO GROSSO&#13;&#10;DEPARTAMENTO=SECRETARIA DE ESTADO DE JUSTIÇA E DIREITOS HUMANOS&#13;&#10;DIRETORIA=SECRETARIA ADJUNTA DE ADMINISTRAÇÃO PENITENCIÁRIA&#13;&#10;SKIN=mxskin27.skn" VendorLib="fbclient.dll" Connected="True" PropData="05704C65667402600470546F700229"/>
    <TfrxDBXQuery Name="Sqlendereco" UserName="Sqlendereco" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.rgi, i.nome_interno, i.endereco, i.fone, p.pavilhao, g.galeria,&#13;&#10;c.cela, s.solario, n.nome_up, pr.proedencia                                      &#13;&#10;&#13;&#10;&#13;&#10;from interno i&#13;&#10;&#13;&#10;&#13;&#10;   INNER JOIN PAVILHAO p ON (I.idpavilhao = P.id_pavilhao)&#13;&#10;   INNER JOIN GALERIA g ON (I.idgaleria = G.id_galeria)&#13;&#10;   INNER JOIN CELA c ON (I.idcela = C.id_cela)&#13;&#10;   INNER JOIN SOLARIO s ON (I.idsolario = S.id_solario)&#13;&#10;   INNER JOIN unidade_penal n ON (I.id_up = n.id_up)&#13;&#10;   LEFT JOIN procedencia pr ON(i.id_procedencia = pr.id_procedencia)                                                                                                                                                         &#13;&#10;&#13;&#10;WHERE I.ST = 'A' AND I.ID_UP = :ID_UP AND pr.proedencia  like '%' || :procedencia || '%'                    &#13;&#10;order by pr.proedencia                                                                                           " Database="database" PropData="05704C65667402600470546F7003A4000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C4A000000204E616D653D2270726F636564656E636961222044617461547970653D226674537472696E67222045787072657373696F6E3D22436F6D626F70726F636564656E6369612E74657874220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlListagem" UserName="SqlListagem" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT ID_PROCEDENCIA, PROEDENCIA                                                                                                                                        &#13;&#10;  &#13;&#10;FROM PROCEDENCIA                                                &#13;&#10;&#13;&#10;  &#13;&#10;ORDER BY PROEDENCIA                                             " Database="database" PropData="05704C65667403C4000470546F70025C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="267" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="336" Width="680,3154">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="680,3154" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="20,6771678" Left="0" ParentFont="False" Top="232" Width="680,3154" ColumnWidth="0" ColumnGap="0" DataSet="Sqlendereco" DataSetName="Sqlendereco" RowCount="0" Stretched="True">
      <TfrxMemoView Name="SqlConferePAVILHAO" Left="546,2359715" Top="0,77953" Width="130,82684" Height="18,8976378" DataSet="Sqlendereco" DataSetName="Sqlendereco" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Sqlendereco.&#34;GALERIA&#34;] - [Sqlendereco.&#34;SOLARIO&#34;] - [Sqlendereco.&#34;CELA&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="41" Top="0,31478" Width="50,48825" Height="18,89765" DataSet="Sqlendereco" DataSetName="Sqlendereco" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Sqlendereco.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="SqlConfereNOME_INTERNO" Left="98,57483" Top="0" Width="441,23655" Height="19,6771678" StretchMode="smMaxHeight" Cursor="-12" DataField="NOME_INTERNO" DataSet="Sqlendereco" DataSetName="Sqlendereco" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="8" ParentFont="False" Text="[Sqlendereco.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="2,33859" Top="0" Width="34,01577" Height="18,8976378" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="00" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Line]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="45,35436" Left="0" Top="272" Width="680,3154">
      <TfrxMemoView Name="Memo9" Left="7,55905512" Top="17,007874015748" Width="387,4015748" Height="18,89764024" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="12" ParentFont="False" Text="Total de MatrÃ­culas: [COUNT(MasterData1)]"/>
    </TfrxReportSummary>
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="155,29932" Left="0" ParentFont="False" Top="16" Width="680,3154">
      <TfrxMemoView Name="Memo3" Left="1,22047" Top="135,40167" Width="676,33117" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="12" HAlign="haCenter" ParentFont="False" Text="LISTAGEM INTERNOS POR PROCEDÃNCIA"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="7,55906" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="68,03154" Width="718,1107" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture1" Left="608,50433976" Top="8,55906" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="3,77953" Top="23,67717512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxReportTitle>
    <TfrxGroupHeader Name="GroupHeader1" Height="18,89765" Left="0" Top="192" Width="680,3154" Condition="Sqlendereco.&#34;PROEDENCIA&#34;">
      <TfrxMemoView Name="SqlenderecoENDERECO" Left="0,33859" Top="0" Width="680,19703591" Height="18,89765" DataSet="Sqlendereco" DataSetName="Sqlendereco" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Sqlendereco.&#34;PROEDENCIA&#34;]"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="151" Left="265" Top="150" Width="323" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="8" Top="16" Width="155" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Tahoma" Font.Style="0" ParentFont="False" Caption="Escolha a procedência" Color="13948117" OnClick="Label1OnClick"/>
    <TfrxButtonControl Name="btnOk" Left="8" Top="76" Width="75" Height="25" Caption="OK" ModalResult="1"/>
    <TfrxComboBoxControl Name="ComboProcedencia" Left="8" Top="41" Width="288" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
  </TfrxDialogPage>
</TfrxReport>
