<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="43185,7046240394" ScriptLanguage="PascalScript" ScriptText.Text="
function ExtractFilePathSiapen(const FileName: string): string;&#13;&#10;var&#13;&#10;  LastDelimiterPos: integer;&#13;&#10;begin&#13;&#10;  LastDelimiterPos := Length(FileName);&#13;&#10;  while (LastDelimiterPos &#62; 0) and (FileName[LastDelimiterPos] &#60;&#62; '\') and (FileName[LastDelimiterPos] &#60;&#62; '/') do&#13;&#10;    Dec(LastDelimiterPos);&#13;&#10;&#13;&#10;  Result := Copy(FileName, 1, LastDelimiterPos);&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;
procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var i:integer; set: boolean;                                                           &#13;&#10;begin&#13;&#10;                   &#13;&#10;   if(CheckBox1.Checked = True ) then&#13;&#10;   begin                      &#13;&#10;       SqlExportar.Sql.Add('and (h.Setor = ''Assist. Social''');&#13;&#10;       set:=True;                             &#13;&#10;   end;                      &#13;&#10;   if(CheckBox2.Checked = True) then&#13;&#10;   begin&#13;&#10;       if(set=True) then SqlExportar.Sql.Add(' or h.Setor = ''Saúde''')&#13;&#10;       else&#13;&#10;       begin&#13;&#10;               SqlExportar.Sql.Add('and (h.Setor = ''Saúde''');&#13;&#10;               set:=True;                                     &#13;&#10;       end;                &#13;&#10;   end;&#13;&#10;   if(CheckBox3.Checked = True) then&#13;&#10;   begin&#13;&#10;       if(set=True) then SqlExportar.Sql.Add(' or h.Setor = ''Psicologia''')&#13;&#10;       else SqlExportar.Sql.Add('and (h.Setor = ''Psicologia''');&#13;&#10;   end; &#13;&#10;   SqlExportar.Sql.Add(') order by h.data_hora');                                                             &#13;&#10;                    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  { IF &#60;GLOBAL_CONFERE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end; }&#13;&#10;  DateEdit1.Date := Now-365;&#13;&#10;  DateEdit2.Date := Now;&#13;&#10;  Database.Params.LoadFromFile(ExtractFilePathSiapen(Application.exeName)+'..\config\dbxconnections.ini');&#13;&#10;&#13;&#10;                          &#13;&#10;end;   &#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin                                         &#13;&#10;  // SqlExportar.Sql.Add(Memo6.Lines.Text);                                                                                                              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure CheckBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3000000020446174615365743D2253716C4578706F727461722220446174615365744E616D653D2253716C4578706F72746172220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C16000000204E616D653D22474C4F42414C5F434F4E464552452200010C1A000000204E616D653D2249445F5550222056616C75653D22383031312200010C3F000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F2045535441444F204445204D41544F2047524F53534F272200010C58000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227534543524554415249412044452045535441444F204445204A55535449C7412045204449524549544F532048554D414E4F53272200010C54000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D2227534543524554415249412041444A554E54412044452041444D494E4953545241C7C34F2050454E4954454E4349C152494127220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="fbclient.DLL" PropData="05704C65667403B4000470546F700240"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="database" PropData="05704C65667402600470546F7002640A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlExportar" UserName="SqlExportar" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT i.NOME_INTERNO, h.DATA_HORA, h.DESCRICAO&#13;&#10;FROM HISTORICO_INTERNO h&#13;&#10;inner join interno i on (i.ID_INTERNO = h.IDINTERNO)&#13;&#10;where h.data_hora &#62;= :inicio and  h.data_hora &#60;= :fim and i.ID_UP = :ID_UP &#13;&#10;                                                " Database="database" PropData="05704C65667402680470546F7003C8000A506172616D657465727301010C40000000204E616D653D22696E6963696F222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746545646974312E446174652200010C3D000000204E616D653D2266696D222044617461547970653D2266744461746554696D65222045787072657373696F6E3D224461746545646974322E446174652200010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" Orientation="poLandscape" PaperWidth="390" PaperHeight="210" PaperSize="256" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" Columns="1" ColumnWidth="211,9" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Courier" Font.Style="0" Height="18,89764024" Left="0" ParentFont="False" Top="56" Width="1398,4261" ColumnWidth="0" ColumnGap="0" DataSet="SqlExportar" DataSetName="SqlExportar" RowCount="0">
      <TfrxMemoView Name="SqlConfereNOME_INTERNO" Left="35" Top="0" Width="261,95275591" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;NOME_INTERNO&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="296,953" Top="0" Width="98,18110236" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;DATA_HORA&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="395,1342" Top="0" Width="1000,7798937" Height="18,89764024" DataSet="SqlExportar" DataSetName="SqlExportar" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[SqlExportar.&#34;DESCRICAO&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="1,30705" Width="34,953" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="[Line]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle1" Height="18,89765" Left="0" Top="16" Width="1398,4261">
      <TfrxMemoView Name="Memo5" Left="35" Top="0" Width="261,953" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NOME"/>
      <TfrxMemoView Name="Memo1" Left="296,953" Top="0" Width="98,1812" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="DATA"/>
      <TfrxMemoView Name="Memo3" Left="395,1342" Top="0" Width="1001,2919" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="DESCRIÃ‡ÃƒO"/>
      <TfrxMemoView Name="Memo6" Left="0" Top="0,10235" Width="34,953" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="NÂº"/>
    </TfrxReportTitle>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="400" Left="441" Top="142" Width="400">
    <TfrxButtonControl Name="Button1" Left="64" Top="115" Width="75" Height="25" Caption="Ok" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="221" Top="115" Width="75" Height="25" Caption="Cancelar" ModalResult="2"/>
    <TfrxDateEditControl Name="DateEdit1" Left="30" Top="40" Width="145" Height="21" Color="-16777211" Date="42690,5549367014" Time="42690,5549367014"/>
    <TfrxDateEditControl Name="DateEdit2" Left="219" Top="40" Width="145" Height="21" Color="-16777211" Date="42690,5549367014" Time="42690,5549367014"/>
    <TfrxCheckBoxControl Name="CheckBox1" Left="60" Top="78" Width="107" Height="17" Caption="Assistente Social" Color="-16777201" OnClick="CheckBox1OnClick"/>
    <TfrxCheckBoxControl Name="CheckBox2" Left="169" Top="78" Width="54" Height="17" Caption="Saúde" Color="-16777201"/>
    <TfrxCheckBoxControl Name="CheckBox3" Left="230" Top="78" Width="98" Height="17" Caption="Psicologia" Color="-16777201"/>
    <TfrxLabelControl Name="Label1" Left="2" Top="5" Width="65" Height="19" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Alignment="taCenter" Caption="Período" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
